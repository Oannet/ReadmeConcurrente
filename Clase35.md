2024 09 18 10 04 27 - YouTube
https://www.youtube.com/watch?v=ZMqdoKF6pMQ

Transcript:
(00:00) Bueno antes de empezar les quería comentar que este habían preguntado Que Cuántas tareas y prácticas iban a ser y si ya vi Este voy a Bueno vamos a tener seis seis y seis cada una así que ahorita ya vamos en la tres de ambas no O sea ya y este después de la tarea después de la tarea se y se no O sea bueno seis tareas y seis prácticas no buen ya vamos a la mitad estamos en septiembre está perfecto no y este bueno eso entonces después de la tarea cuatro y también práctica cuatro va a ver el Prim va a estar el primer examen
(00:58) este ya les había comentado no que el primer examen Sí o sea los exámenes sí son individuales y este y iba a tratar de los primeros cuatro temas o sea hasta hasta este y ya este e ya ahí les digo faltarían dos tareas y dos prácticas más no cómo van a hacer los exámenes pues hagan de cuenta que les dejo eh Como pues ahora sí que como una tarea no O sea les doy las instrucciones y en vez de dejarles una semana les dejo TR días y son individuales no Entonces sí es un poquito más pesado pero en realidad tampoco me parece o sea si han hecho las
(01:37) tareas no me parece como como tan difícil zuriel este ah les estaba comentando que Ah creo que tú me habías preguntado no que que Cuántas tareas y prácticas iban a hacer ya decidí que sí seis bueno Estaba viendo el calendario así para ver como cómo me da tiempo y sí seis seis de cada una Enton estaba comentando que ahorita llevamos tres no e de cada una no entonces el examen les estaba comentando que va a ser después de la tarea cuatro y de la práctica cuatro eh Y le estaba diciendo a Sara que que este que van a ser
(02:19) individuales entonces que en vez de darles Yo s días les doy nada más tres y pues lo resuel en individual este y que pues en realidad están basados en la tarea o sea en no me parece que estén tan O sea no son tan distintos no de lo que ya han hecho se supone que las tareas son para que practiquen no eh Entonces no no de no debe estar tan difícil los anuncios no al inicio los anuncios del inicio y y este Ajá Igual yo me voy a ausentar el la semana del de octubre del 15 del 14 al 18 así que ya veré este cómo les dejo las Bueno o sea como
(03:06) que estaba Sí calculando más o menos a igual ahí nada más les dejo como la tarea cinco y ya de allá más nos faltaría otra tarea y dos prácticas entonces Este sí nos va a dar tiempo bien Incluso si me ausento esta semana pero bueno son sonos anuncios Vale entonces Bueno ahorita qué sigue tarea cuatro práctica cuatro la práctica cuatro Me parece que está muy sencilla pero bueno a ver qué les parece y este y luego el examen dos el examen uno digo es que me quedo pensando No si nos va a dar tiempo del examen dos pero que nunca
(03:43) me da tiempo cuando porque han habido paros entonces nunca termino haciendo examen dos pero bueno E eso no a los anuncios Entonces ahora sí e record prog Ah bueno nos habíamos quedado en los snapchats atómicos no la idea de un Snap Es tener cuá Es el examen exactamente les voy a mandar una como dura 3 días siempre les mando una encuesta para ver cuandoo hace mejor pero la idea es que sea del eh tres Ajá sí sí sí digamos que entre el 3 de octubre y el 12 de octubre vale o sea por ejemplo me gusta dejárselos como estilo les dejo el viernes y lo entregan
(04:47) el domingo o dejarlo el lunes y que lo entreguen el miércoles o dejárselos el miércoles y que lo entreguen el viernes entonces este más o menos cálculo sí no lunes y lo entregan el miércoles Bueno también luego me ha pasado que como que ustedes trabajan o no sé qué hacen los sábados los los fines que les queda mejor entre semana Entonces pero les mando la encuesta Ya pues el día que gane ese día lo hacemos este y bueno lo Lo bueno es que les dejo tres días Lo malo es que les sigo dando clase entonces o sea bueno la clase en
(05:24) la que se las dejo pues sí la leemos pero sí es este o sea seguimos con la clase pero bueno les digo como que el examen En realidad lo hago como las tareas para 2 horas según yo no no sé si sí realmente las hacen así eh Entonces ahora sí [Música] em Entonces nos habíamos quedado en que el Snapchat atómico te permite leer múltiples registros de forma atómica no Y la idea es que tienes un conjunto de multi multi readers o sea varios lectores y un solo escritor Entonces el arreglito se ve de esta forma tenemos un
(06:08) arreglo de registros de este estilo entonces cada hilo tiene su propio este registro entonces cada hilo va a poder escribir en su solo registro por eso son single writer no solamente el hilo al que le corresponde y este y cuál quilo puede leer todos los registros por eso son multier no Entonces es la idea de este arreglo Pero además el objetivo es que literal o sea los leas de forma atómica o sea como que te los s lo separen no ahí con una cámara no tomen una foto y aparezcan exactamente todos los últimos valores
(06:54) escritos en el arreglo Esa es la idea e [Música] okay Entonces tenemos este arreglo y los dos métodos que utilizan los hilos para pues hacer estas dos cosas no escribir solo su registro y leer todos son scan y update Entonces el método scan lo que hace pues es que construye una vista instantánea del arreglo de registros y es muy importante no sea instantánea o sea atómica y el y el este el método update pues actualiza el valor V en el registro del proceso no O sea por ejemplo No pues el hil lo quiere actualizar hace un
(07:37) update entonces pone su valor V aquí no en su propio registro No puede escribir en el en el de los demás entonces este esta lo que regresa scan Pues yo les había comentado que es como una foto no clac no Entonces en realidad pues analizando no listo en código pues es nada más es este simplemente una colección de valores los últimos valores que están escritos en el registro Perdón en el arreglo no en el arreglo de registros y Bueno les encanta decirlo con artículos no que que esta colección de valores representan el
(08:17) estado del sistema Pues sí O sea la colección de valores ya entonces el scan corresponde a la O sea lo que regresa cada scan corresponde a la última actualización de todos es es decir tiene el scan debe regresar la última llamada update que lo precede o también puede regresar algunas que son concurrentes y si caracterizamos no lo que regresa el scan como Pues el conjunto V entonces podemos analizar cada vista que nos regrese el escan las podemos agrupar por contención de esta forma o de esta forma y es muy importante que la
(09:01) característica del objeto snapshot Es que todas las vistas se pueden agrupar de esta forma siempre una contiene a otra entonces Déjenme bueno ya les había puesto yo El ejemplo aquí pero hago una limpia no para repasar Este ejemplo Entonces por ejemplo tenemos Tenemos aquí una historia no aquí en el tiempo de los filos A B y C no Entonces les había comentado no que lo que hacemos pues es escribir y hacer scan es lo único que hacemos Entonces por ejemplo no si escribimos aquí un update eh Ah no e Aquí hacemos un update
(10:04) [Música] y DC Entonces por ejemplo si hacemos aquí un [Música] scan está muy pequeño por unan y el scan regresa a una vista v y supongamos no que Este hace otro otro scan V prima Vale entonces siempre cada dos vistas O sea la característica muy importante de los snapchats es que cada dos vistas a una vista es el conjunto de valores que están escritos en el arreglo por ejemplo este es el arreglo de el arreglo de registros y entonces cadao pues escribe en su propio e registro no en este arreglo Y en este registro con los métodos update pues van
(11:08) a estar escritos aquí por ejemplo si al hilo a le corresponde el registro uno Pues aquí está el a no eh y ya luego lo actualiza b y por ejemplo supongamos que el c pues está aquí no el tres es c entonces una vista es la colección de los valores escritos en en el arreglo vale entonces la gran característica que tienen los snapshots Es que todas las vistas que tomen los scans se pueden ordenar en contención Entonces por ejemplo siempre va a pasar Eh que se cumple esto o al revés o sea también puede ser que esta
(11:45) contenga esta pero por ejemplo como y la gran característica esa colección es tamaño del arreglo puede ser por cachos no es del tamaño siempre va a ser de tamaño n no n hilos en N registros entonces la vista es de N O sea todo todo es de n y este entonces e por ejemplo qué puede ser que que V como es concurrente con el update de a pues puede tener a No él puede tener a pero como sucedió antes que update B pues claramente no va a tener update b e Entonces no sé tiene a aquí pues no sé no tiene nada es el valor inicial vale cómo puede ser una
(12:35) vista previa contenida en la subsiguiente Ajá sí mira a eso voy voy y Y entonces también del hilo c por ejemplo este es el hilo A B y C no de lo a este scan puede o no ver no al update porque pues son concurrentes supongamos que sí lo ve entonces aquí está el valor de a el que actualizó el y lo a Ay que actualizó el lo a entonces B pues no escrito nada y C tampoco no y b prima cómo sería pues B prima También sucedió después del update de a Así que pero es concurrente al update de B Así que puede tener eh la actualización previa o la
(13:17) actualización con la que es concurrente porque cumple con analizaba Okay entonces supongamos no que B la concurrente y como como B no ha hecho nada no O sea no ha escrito nada el hilo b y el hilo c Pues en realidad hace lo p después no Entonces no ha escrito nada Y entonces quiere decir que eh las vistas por ejemplo no en este caso se contienen Por qué Porque el conjunto no de valores que tiene V está contenido en el conjunto de de valores que tiene B por qué puso b y no a al principio Ah porque como es linealiza ser que el scan de
(14:11) B contenga a o no Porque son concurrentes no O sea por ejemplo si las ordenamos así decimos que primero pasa el update b y luego el escan no Aunque para mén podría ser que no podría ser que no lo contenga no puede ser que contenga a a o no o perdón a a o a b vale Pero a a Sí o sí o sea si no contiene a b Pues a fuerzas debe contener a que es la otra actualización vale Esa es la idea Este pero ahorita vamos al código entonces eh digamos que lo que los los elementos que están aquí este van a estar contenidos acá y de
(14:50) hecho no O sea este tiene todavía la actualización última de lo que tenía este otro no pero ignoró Ah aunque ya había pasado antes Ajá sí es que digamos que esto sobreescribe no Ajá Dice Eduardo pero en este caso V prima contiene a b si B prima contiene a b y no a a mm Okay okay O sea digamos que esa esa sería como la diferencia no este HM es que a ver sí O sea tienes razón no tengo que explicar de otra forma H bueno supongamos que es que sí O sea cuando se actualizan pues se pierden no O sea o sea es digamos que lo que hace
(15:40) el update Pues es sobreescribir lo anterior no Entonces digamos que esto tiene todos los valores más un valor actualizado de este no pero claro o sea tendríamos que como que ir guardándolos todos no O sea supongamos que tenemos a b Ahora aquí y el valor viejo Pues será no pero pues es un valor viejo entonces decimos que lo contiene pero sí O sea Eduardo hay que considerar que no bueno supongamos que este guarda también los valores viejos no Sí bueno es que estaba pensando cómo se los cuento sin código Pero bueno les
(16:28) parece Ajá sí se da por Sí pues sí como que se da por tiempo hagan de cuenta que la idea es que todo lo que está acá pues se contiene no lo único que puede diferenciar entre dos dos vistas Es que este pues tenga un valor más actualizado que este otro no Entonces por ejemplo hablando como se acuerdan de los snapshots atómicos no que yo les había comentado que tenían estampas Entonces por ejemplo s aquí como que no es considerar que que a por ejemplo la estampa el timestamp de uno no y b tiene el timestamp de dos entonces eh Como
(17:07) ordenarlos así por contención sabiendo que tú tienes un valor más actualizado no O sea que en algún momento pues estuvo este otro vale Eduardo como que así pero bueno ahorita les enseño el código para que vean dice y en v prima los est invertidos de después siguen refiriéndose a B y C Ajá sí Exacto Sí o sea los Ajá pero si te das cuenta ve no hizo Sí sí Bueno ahorita vamos a ver el código vale Este suriel dice siguen refiriéndose a B y C aunque ya haya pasado B Ajá sí hae cuenta que me refiero a que inicialmente digamos que todos los
(17:49) valores tienen este tienen como m no O sea no tienen nada están Como inicializados así entonces eh digamos que lo que ve este scan este scan es el valor de a o el de B No pero este scan lo que ve en el registro de B pues es nada o sea ve aún no ha escrito nada no por eso sigue inicializado Y en este caso este bueno el scan como después es el update después de este scan este scan pues no no pudo verlo o sea en la vista no sale lo que escribió después s o sea digamos que se refiere no a lo que leyó en B a lo que leyó en C
(18:32) Que es que es nada no O sea como la inicialización Vale entonces este cómo se ve esto no Ah bueno Cómo se vería un snapshot secuencial O sea ya hay que poner en código no esto que les estoy contando tenemos un arreglo de registros atómicos muy importante son atómicos Enton entonces pues tienen esto de las Tim Este aj pero bueno creo que no lo ponen no no lo ponen Pero bueno es un arreglo de registros atómicos entonces snapshot secuencial o sea sin concurrencia por eso tiene sincron es secuencial entonces simplemente se se crea de esta forma no
(19:25) sea tenemos este la no de la capacidad de n no sé y se se inicializa cada arreglo en un valor in inicial sea yo en este caso pues casi siempre les asigno como el valor inicial este simbolito como que no hay nada entonces después el método update pues simplemente escribe en tu registro y el scan lo que nos dice es este crea un vas a regresar no un resultado y este resultado pues es un arreglo de todo lo que leas entonces simplemente lo que vas a hacer es que vas a poner cada valor del del registro este en en cada
(20:15) valor del result no y lo que vas a regresar va a ser este arreglo de valores Vale entonces así se ve el código entonces bueno si es secuencial pues simplemente sería así O sea un solo hilo no no sé en Java pues nuestro oo Main hace updates y hace vistas no se aquí la vista Bueno aquí sí les ped dio no pero bueno este hace updates así se es sería no no hay como mucha mucha dificultad no Entonces digamos que las vistas pues deberían Regresar todo lo anterior no esta vista Entonces si sucede otra vista bueno sea si sucede
(20:56) esta vista de acá Bio prima pues tiene que tener lo último no yasí se no hay mucha dificultad si es de forma secuencial la dificultad cuando lo hacemos de forma concurrente No es que pues cómo hacerle no dificultad ser que tengamos actualización Tenemos aquí un no s de a de B Entonces cuál va a ser la dificultad de de hacer un un este una implementación concurrente Es que este Pues que un hilo no el hilo a esté
(22:03) haciendo un escan Y entonces mientras el hilo B y C estén actualizando su registro entonces La idea es regresar una foto no en algún punto Entonces por ejemplo si la foto la tomaste aquí no pues tienen que estar los dos sub pero si la foto la tomaste o sea como que es la idea no si la foto la tomaste aquí pues puede ser que solo esté el update de a no la idea es que lo que es difícil es que veas a todos los que se están moviendo en la foto no O sea como que tú intentas tomar la foto y mientras aquí están actualizando el registro no y
(22:39) claramente actualizar algo o sea solamente tu registro es más fácil o sea te lleva menos cómputo que leer todos no Esa es la idea entonces la dificultad está en eso en en que si tomas la vista y sale el update de B Pues debería salir el update de a porque eso se hizo antes entonces la dificultad está en eso en en los traslapes de scan con updates vale o sea como cl es que en la foto ahy no se muevan todos no si salgan entonces a me Aquí les había puesto Ajá Entonces es como que siempre las tenemos que ordenar vale en
(23:27) contención entonces Así se ve aquí se ve no claramente si haces este por ejemplo esta vista puede tener a cualquiera de las dos no a esta o a esta pero esta vista puede tener debe tener a fuerzas a esta no Y puede tener este a esta no pero por ejemplo como son concurrentes estas se tienen que ordenar de alguna forma en contención o sea de acuerdo a los elementos que tienen y y el scan este de B3 a fuerzas tiene que tener al último actualizado entonces B3 siempre va a tener una relación o sea pues siempre va a tener más elementos no porque pasó
(24:11) después en el tiempo entonces esta Va a ser la dificultad e entonces Bueno vamos al primerito al primer snapshot que es un snapshot que es obstruction free alguien se acuerda que es obstruction free ya se los había comentado este es una les empiezo a contar no es una condición de Progreso se acuerdan es bloqueante o no bloqueante en las condiciones de Progreso no no bloqueante exacto no bloqueante Y además De qué trata e nos dice que los kilos progresará siempre y cuando vayan solos es decir que por ejemplo puede ser que que acá
(25:17) Este haya así como operaciones operaciones no operaciones y por ejemplo no tenemos este trilito que no progresa Mientras hay operaciones Pero sí va a terminar cuando deje de haber o sea cuando vaya solo no ent en este momento el hilo c el hilo c se va solo no o sea es la idea que no se traslapa con nadie entonces va a acabar pero si se anda traslap con alguien no va a acabar entonces la idea de este snapshot de esta primera construcción es que un scan puede no terminar si hay varios updates que se están haciendo todo el
(26:08) tiempo está como chafa no pero bueno es como la primera implementación Y este justo le dicen no como el Snapchat simple Entonces es la idea los updates acaban siempre acaban son we free los updates este método es sea solamente escribes tu registro y ya está y te vas no O sea solamente escribes y te vas y los scan este como quieren todo el tiempo tomar la foto y pues si están viendo que se están moviendo siempre no van a acabar hasta que vea que nadie se movió en la foto dice Ah mira les doy el resultado entonces esa es la idea de
(26:46) este algoritmo ah miren aquí se utiliza no entonces utilizan un arreglo de multier single writer como les había comentado no o sea los los registros son de registros que pueden ser leídos por muchos escritos por solo uno atómicos y son del tipo que tienen las estampas vale lo que les había comentado que tienen Pues los timestamps para ordenar las lecturas no de forma atómica entonces Eh bueno bueno creo que es lo más que vemos aquí en esta implementación Entonces vamos a inicializar no en la capacidad y pues inicializando en el
(27:23) tipo de valor porque pues aquí nada más especifica no algún tipo de valor de de entonces este el arreglo de registro se inicializa no de este tipo de registros de Stand value atómicos multier single writer del tamaño de la capacidad y cada uno se inicializa este con con no inicialmente supongamos que Pues todos tienen nada No pues están emp Están vacíos entonces este como les había comentado no update va a ser free o sea un hilo llega escribe y se va y ya él acaba a él no le importa a nadie y el scan va a ser
(28:04) obstruction free los hos van a terminar solamente si este si van solos Entonces el update pues es es el método fácil Vale entonces cómo se ve pues simplemente quieres quieres actualizar el valor revisas cuál es tu ID en el arreglo porque ese es el que te responde siempre Y entonces e guardas El Bueno esto esto es cuestión de los del Stand value vale de los este de la clase Stand Val lo que hace esta clase es que guardas El viejo valor no e digamos que bueno s se ve guardas El viejo valor aquí luego eh el nuevo valor
(28:54) lo pones este como el viejo valor Eh bueno digamos que la estampa vieja le aumentas uno y luego pones tu valor entonces aquí se ve Eduardo como que o sea digamos que porque ves que me habías preguntado no O sea pero cómo se contienen dos vistas si esta vista este por ejemplo no O sea era teníamos a así y así no luego acá teníamos B así y así entonces B era un valor este por ejemplo no sé una timestamp de I + 1 y este timestamp la la estampa de tiempo no tiene un valor de de I Entonces digamos que la contención no se hace o sea
(29:47) puedes tener este eh Como que la la consideran si tienes simplemente un valor más actualizado lo consideran contención Ajá dice me es un arreglo sí es un arreglo es el arreglo de registros es este este del que les estoy hablando todo el tiempo no este es el Table y el Table me pues es el el registro que me corresponde no este puede ser el uno el dos o sea depende el ID entonces La idea es que solamente escribes en tu registro el nuevo valor y el nuevo valor es tiene la estampa más actualizada con el valor no Entonces es la idea como que le
(30:35) es el viejo les le aumentas el timestamp y pones tu valor Vale entonces por ejemplo no si el viejo valor era a con el con su timestamp de I no y el nuevo valor Pues en el timestamp le sumas este uno y el valor pues es el valor que estás metiendo no sé si si quieres actualizar a b pues va así y eso se guarda en el nuevo valor no O sea como que todo el tiempo están tomando las estampas de tiempo este y por eso dicen que hay contención no porque sí O sea tal vez no tienes ese valor justo pero tienes un valor actualizado y lo
(31:16) consideras como que este tienes el siguiente no O sea que puedes tener a pero tienes el actualizado que es B entonces este este método lo que nos hace pues es que cada hilo por ejemplo el hilo este I escribe con update este V el valor V en su registro y no Entonces no sé escribe aquí V es la idea de este de este método Y pues si ven como que claramente es weight free eh Por qué qué nos decía weight free nos decía todo todo hilo este va a acabar Eh bueno si no infinitamente seguido infinitas veces eso es lo que nos decía
(32:15) wf pero la idea es que wif se al final no es conclusión todo el mundo acaba Pues sí no todo el mundo acaba porque de hecho el único que puede escribir en este arreglo Pues soy yo no entonces o sea bueno es el hilo el hilo cada hilo no O sea si es el hilo a Pues solamente el hilo a puede escribir en su en su ID y solamente el hilo a pues este escribió antes un valor viejo entonces aquí no hay como alguien que le o sea como alguien que haga concurrente algo con él no en su registro entonces este acaban acaba pone su nuevo valor No hay nadie
(32:52) como que eh interfiera eh escribiendo este escribiendo su registro en este caso no solamente escribe el hilo al que le corresponde y acaba siempre acaba no ha no hay nadie que lo pare entonces e Bueno cómo cómo se ve el scan es el otro método que este es el obstruction free método scan pues miren lo que va a tener el scan es una dos arreglos de El tamaño del registro Vale entonces copy y New copy son dos arreglos de tamaño n vale o sea suponiendo que de un a n Entonces el primer arreglo este digamos que se va a obtener no se
(33:49) va a llenar haciendo un un este un método que se llama collect y bueno Ahí voy no es un collect Pues un collect simplemente es es este método lo que hace el collect Es que le en un for todos los todo lo que está guardado en a Table Vale entonces simplemente que hace aquí pues crea el arreglo que va a regresar que es la copy que es del tamaño este de tamaño n e luego le cada cada registro de table y lo guarda en copy no cada en cada este elemento de copy y regresa copy es un collec pues simplemente es leer en forno leer en un for este
(34:50) todos los registros y regresa una reg de lo leído no es lo que hace collect un for Entonces el scan este les había comentado no que tiene dos arreglos de tamaño n Entonces el primero en el copy qué hace pues eh Lee todos los registros no entonces y los guarda copy entonces después qué nos dice no eh va a bueno La idea es como regresar ahí Pero bueno vamos a empezar del Wi Entonces nos dice mientras sea verdadero no este vamos a leer otra otra vez el collect e
(35:53) Lee otra vez y guarda en en New copy No aquí regresas la All copy y aquí en New copy no entonces vuelves a leer todo lo guardas en una nueva copia y en la línea 28 lo que vamos a hacer es que vas a comparar vas a decir si los arreglos no son iguales entonces Haz que la vieja copia sea la nueva copia no O sea como digamos que es como eh considera considera la nueva copia como la vieja y contin a collect o sea Regrésate a la línea
(36:55) 26 Y entonces ahí te la vas a pasar mientras sea verdadero entonces vuelve a saler una nueva copia y ahora como ya la vieja copia pues era la última no O sea justo la vieja copia es la última que leíste vuelves a comparar no Y hasta que te salgan iguales sales de aquí no O sea si si no salen iguales pues te vas a pasar ir dando vueltas pero si sí salen iguales entonces llegas a la línea este 32 no si digamos que aquí si alguien se movió y acá voy a ponerlo en rojo si nadie Se movió O sea no hay ningún update nuevo entonces si no hay un
(37:53) update nuevo simplemente Qué haces regresas este o un este un arreglo result bueno sea crece el arreglo result del tamaño de n Y pues simplemente copias bueno Esto lo hacen así como para regresar justo nada más como la vista entonces regresas el arreglo los valores solamente los valores de cada este de cada de cada valor en el arreglo Pues los copias o sea literal es otro for no Y regresas result Entonces digamos que pues no es así es la idea de esto es si alguien se mueve vuelve a tomarlo no vuelve a tomarlo vuelve a
(38:36) tomarlo hasta que nadie se mueva o sea y ya que nadie se movió pues simplemente te encargas de fabricar results y lo regresas Entonces qué regresas un arreglo con los valores leídos de cada registro no es lo que regresamos Entonces entonces aquí se ve no claramente este scan pues ejecuta dos collec al menos ent La idea es que si la primera copia es igual a la segunda regresa los valores pero si no vuelve a tomarlo y vuelve a tomarlo Pero bueno al menos son dos veces entonces e este Ah bueno por ejemplo no cómo cómo
(39:20) se vería aquí pues podría ser que este bueno eh tenemos un arreglo de registros Déjenme Creo mejor este otro acá [Música] no tiene Bueno voy a ponerle un cualquiera así no lo vemos entonces Bueno vamos vamos a tener no tenemos un arreglo para solo quedarnos con los registros que son entonces son los registros a b c Entonces es Este es el arreglo a Table
(40:30) vale Y entonces supongamos que por qué regresamos a Table en lugar de simplemente pues yo siento que este como el Es que mira como que es así como una cosa como más como de de práctica como que para que represente lo que es pero es que mira el collect te acuerdas que St value este por ejemplo Aquí vemos no que St value en realidad tiene e el value y el stamp no O sea digamos que el los el la clase stamp value son este no son instancia del stamp value eh equivale a un timestamp y al Val no Bueno creo que aquí le llaman tal cual
(41:33) estamp no Bueno voy a ponerle St entonces este el collect lo que hace Es simplemente guardar todo o sea guarda el collect guarda todo esto no entonces las copias eh Son son este son O sea la copia pues es una es es el conjunto de todos los stamp value o sea digamos que todos los valores vienen con sus stamps es la idea entonces aquí lo que hacen simplemente es guardar solamente la parte de value del stamp este Perdón del stamp value no O sea tenemos el stamp value con su stamp y su value o sea y aquí están los
(42:26) timestamp no y aquí pues ya el valor No se ve no Entonces digamos que lo que hacen simplemente es pues regresar V pero o sea como que lo hacen para para que se cumpla como que mira este este Snapchat regresa al conjunto de valores vale o sea sin las timestamp es lo que te dicen pero este Claro que pues ya si lo pasamos a la práctica pues tal vez nos conviene este no s hacerlo de otra forma no a programarlo de otra forma O sea no no es como tan o se consideremos lo seudocódigo esto Este porque sí o sea puede ser que es muy muy este
(43:07) ineficiente no hacerlo así pero bueno e Entonces cómo funciona esto pues cada cada hilo pues va va a llegar a actualizar este su update no perdón actualizar su propio registro en el arreglo entonces este el update eh por ejemplo de a pues quiere escribir el valor uno entonces La idea es que va a escribirlo aquí y luego por ejemplo estas dos son concurrentes Pero no pasa nada o sea cada quien en el update Pues solamente se dedica a escribir sobre su valor no O sea no hace nada más que escribir sobre su sobre su propio
(43:47) registro Así que no pasa nada o sea él escribe b2 aquí sin problemas no pero el problema es que va a hacer que va a regresar el scan no porque por ejemplo supongamos que el scan este hace aquí una copy no y luego haca este una New copy Entonces si el si el update B Se hizo aquí pues eh este va a estar aquí este digamos que el v1 pues va a estar en la All copy No pero si después se vuelve a leer y este ya escribió aquí pues entonces ahora en la nueva copia va a estar la actualización no podría ser e y no va a acabar no entonces después
(44:41) se hace que que se igual a New no y se saca otra nueva copia New copy bueno New este y depende No qué tal que este ya escribió aquí y va a ser va a salir diferente otra vez por qué no O sea digamos que pues La idea es que al final el registro va a quedar este así no O sea hasta el final o sea como hasta acá así se va así se va a ver por qué porque pues el el último valor no que se que hab escrito este hilo Pues será b4 Entonces digamos que Aquí el problema va a ser que el scan puede estar viendo que todo el tiempo alguien se está moviend
(45:27) viendo no S como que él ya quería acabar no pero alguien ya llegó actualizó actualizó actualizó entonces puede ser que se quede ahí entonces sí O sea el método update es Wi free Entonces el progreso de un hilo no depende de otros no Entonces como les había comentado pues simplemente Leo mi propio registro este eh guardo el value de mi propio registro luego modifico mi propio registro Y quién más puede escribir en mi registro pues nadie más que yo no Entonces yo es un un hilo acaba en un número finito de pasos
(46:03) siempre este y constantes no O sea nunca hay más pasos eem entonces como que es bueno s sí lo ven no porque es we free bu es pero no si no me me dicen y es obstruction free porque como les comenté no en este ejemplo puede ser que una llamada scan este pues se traslapa con otro update pues va a tener la vieja copia con la nueva copia distintas Y entonces va a tener que volver a hacerlo no Entonces por ejemplo aquí como les había comentado tenemos este en la Table el arreglo de registros no entonces puede ser no que todo el
(47:03) tiempo que por ejemplo este pues tenga efecto aquí no cuándo va a tener efecto el update o sea Cuándo este cuándo realmente digamos que este punto no cuando se haga la línea 14 si se dan cuenta antes todo lo que haga aquí no es percibido por los demás y los no O sea lo que haga antes pues no nos importa está leyendo su viejo valor está actualizando su estampa pues no nos importa a nadie hasta que no haga esta esta línea es que pues va a tener efecto para todos no entonces este Entonces supongamos no que tuvo efecto pues ya la línea 14 ahí o sea
(47:55) aquí en este en esto y no sé después este pues tuvo efecto acá y este por acá o sea no sé la línea 14 pasó por ahí no este Y entonces si este todo el tiempo está leyendo por ejemplo no O sea incluso imagínense que hace una una vieja copia aquí y luego hace una nueva y este dejen escribo más pequeño porque este entonces puede ser que en la vieja pues no estaba V Un no y en la nueva Ya está v1 pues ya no acabó no entonces acá hace digamos que una New New 1 no luego no sé acá acá y acá entonces finalmente esta porj supongamos no New
(48:45) un Pues ahora tiene a este New 2 este pues ahora tiene esta actualización New 3 Pues ahora tendrá esta y son distintas todas no y ya pues ño cu no hay nadie aquí claramente no O sea aquí digamos que c va solo entonces 3 va a ser igual a cu y va a acabar entonces aquí pues finalmente acaba y regresa la vista Entonces qué vista va a regresar Pues esta No justamente esta vista eso es lo que debe tener su vista Entonces digamos que decimos que este scan tiene efecto en este punto vale o sea en este punto tiene efecto entonces
(49:38) quiere decir que todo lo que está antes lo debe tener e entonces Bueno ahorita Vamos a repasar eso de tiene efecto Ay miren me adelanto Bueno entonces este como les había comentado este todo esto que está acá digamos que a nadie le importa no O sea bueno en de forma concurrente Pues tú estás leyendo de forma local este tu ID y luego estás leyendo de forma pues local tu valor viejo o sea nadie le importa eso nadie lo ve no O sea en la concurrencia no nos importa qué estás haciendo aquí solamente nos importa si haces la
(50:18) línea 14 Entonces el scan pues va a percibir que te moviste no O sea la nueva copia le va a salir distinta si sucede la línea 14 entonces la línea 14 va a ser nuestro punto de linealización porque es cuando tiene efecto para los demás hilos no O sea ahí es cuando los demás hilos se percatan que realmente estás haciendo un update mientras no entonces son estos puntos que que yo marco o sea como que pues si sucede Pues por aquí debe estar la línea 14 es justo esa eem Bueno entonces el escan es linealiza porque como como les comenté o sea
(50:58) e va a tener va a tener este el punto justo aquí no está este todavía más más este preciso no el punto de linealización es la línea 28 esta de aquí si se dan cuenta es la línea que este pues nos va a decir No si te vas a regresar al collect o si ya o sea tal cual vas a regresar el resultado no es la diferencia entonces claramente si se dan cuenta en este punto que yao les comenté aquí lo pongo otroo que no se ve Ah en este punto supongamos no que aquí decimos New 3 es igual a New 4 Entonces hasta este punto tiene efecto
(52:02) el método scan y quiere decir que todo después de eso debe estar en la vista dice este collect de arriba porque está como collect es una asignación o algo así cuál en esta página Ah ya el de la línea 27 no este acá Ajá sí este de acá Pues digamos que hay que considerarlo como pseudocódigo Pero la idea es que este o sea es como un nombramiento no por ejemplo este se llama continue collect es que confuso que se llame igual no pero por ejemplo se pudo haber llamado contin continu este no sé Again no no sé algo así y aquí esta
(53:07) línea se llamaría Gen O sea no es precisamente un collect no es este no es no es no es una operación vale o sea solamente es como una referencia no sé si sigue como esto en jav yo no suelo usar esto pero si es es la idea vale como poner la referencia contin continu col collect no O continue Again o lo que sea contin continu a y te regresas a donde está el referencia y vuelves a empezar vale Sí está como extraño no código Pero bueno este estamos en lo de los los puntos entonces eh el punto No donde finalmente va a acabar pues va a ser en
(53:52) la línea como dice la línea 28 este cuándo veamos que son iguales Por qué Porque en ese punto es donde va a acabar y vamos a saber que todo lo que está después no todo lo que está después de esto debe estar Sí o sí sí sí sí este esta práctica snapshots va a ser la cinco sí la cinco la cuatro son spinlock andos andados chidos la cuatro y la cinco son snapshots es que saben para qué los Snapchat haen un montón para backups pero como en tiempo real porque como que te permiten esperarte a que o sea como que en el tiempo todo lo que suceda después
(54:41) de esto debe estar entonces como que es un buen este como Back no pero bueno sí O sea en la práctica cco lo vemos Pero bueno ahorita es como ver los códigos porque creo que después de como filter y no hemos visto una implementación para nilos no ya está así este entonces Ajá qu me había quedado Entonces ese punto es el que nos va a decir este que todo tuvo efecto antes entonces bueno por ejemplo No ya tenemos aquí los casos e el caso uno es si corre solo pues claramente la vista obtenida contendrá el último update por definición no
(55:28) eh A todos los últimos updates o sea claramente si va solo no O sea si es decir este si un esan corre solo se refiere a que pues realmente no hay nadie más ejecutando con él no sea pudo haber sido que hubo aquí como updates No esto son updates updates y finalmente dio aquí no s un scan entonces quiere decir o sea si se dan cuenta pues la All copy va a ser igual a la nueva all igual a New y va a terminar enseguida O sea no va a tardar ahí acaba entonces debe debe contener a todo lo que sucedió antes de que se ejecutara el
(56:18) scan el caso dos es si si se traslap con un update la vista puede contener o no este a y esto está bien porque va a ser correcto bajo la definición de laliz abilidad por ejemplo aquí este en esta imagen les puse yo que este scan es concurrente en el tiempo pues con este update no de a y con este update del valor B entonces quiere decir que puede tener a una o a otra o a las dos o a ninguna Okay eh Y por qué O sea por en el código Podría tener alguna o otra no por ejemplo podría ser que que este que la All copy y la New copy
(57:12) sucedieron aquí no all new y ya aquí pues se tardó un poquito haciendo lo del result no supongamos que se tardó un poquito pero si si la sucedió ahí y la acá y supongamos que no sé la línea 14 de este método de o sea línea 14 que es cuando ya vemos no que realmente hizo la actualización Pues si se dan cuenta este quiere decir que que el scan O sea la vista la B1 Pues no va a contener a y va a terminar o sea puede no tener no puede no tener a en ese caso aunque también podría ser que que este no sé que esta se hiciera antes
(58:01) no y que ambas la O sea que estuvieran este que estuviera en all copy y también estuviera en la New y í acaba no podría ser otra cosa no este podría ser que bueno no sé si esté bien que se los esté borrando dejen se los dejo vale mejor les hago todo así mejor les pongo varios Qué pasa si enviamos una tarea un día tarde les había puesto ahí que este Pero qué tan tarde o sea como ahorita porque Bueno A veces la verdad si entregan unos minutos tarde o unas horas pues se las cuento como normal pero si entregan O sea pues
(58:57) ya como pasadas 12 horas no 8 horas Este sí se las cuento con creo que se retardo de a nu y y al día siguiente Creo que es retardo a ocho una cosa así Ajá dejen Déjenme ver Es que no me acuerdo cómo les cuento Pero por qué no No la has entregado Félix entregaba ayer no Sí o sea No te preocupes Es mejor que le entregues a que no pero sí O sea no tampoco les bajo tanto pero pero sí mejor entregala Okay este y bueno Claro que si te pasó algo no médico no sé como problemas personales o algo así pues no hay problema no O sea me escribes
(59:55) este Ah okay Okay Ah pues si quieren arriesgarse a Ay no disculpenme era mensaje directo sí Híjole Sí bueno una disculpa Félix Chale bueno s Sí si es que no vi Bueno pues bueno sea si quieren arriesgarse este bueno en en la en la descripción del curso está cuánto bajo por día no me acuerdo si bajo ocho y puedes entregar dos días después O si bajo nueve y luego ocho pero si sí bajo a nueve pues no se podrías pensar tal vez este dependiendo Cuántos puntos tenga ese ejercicio Tal vez sí una disculpa Bueno este entonces
(1:00:57) de tarea también sio que hace mucho no los veo su tarea uno Este muy bien muchos se esforzaron Y la mandaron el viernes Habrá
