2024 09 17 09 59 53 - YouTube
https://www.youtube.com/watch?v=zS7TRRQB0ao

Transcript:
(00:29) al al Hola hola Félix cómo están qué tal les fue Hola José en su fin de semana Hola Joel Eduardo qué tal
(01:37) les fue descansaron bien también gracias pudieron descansar Ah qué bueno sí la verdad afecta mucho Si en la pregunta una ponemos más de tres líneas Ah no no se preocupan nada más O sea lo que no queremos la maestra y yo es que nos pongan una cuartilla para que no puedan saben o sea que lo puedan resumir en pocas líneas todo lo que saben pero no no se preocupen si son más de tres Mientras no sea toda una cortilla está bien Hola Luis cómo están Cómo estás muy bien Qué bueno Bien
(02:44) también Pues bien o sea justo quería empezar contándoles de eso porque ahí les va una anécdota que me pasó ayer para que no sé para que ustedes no les pase porque yo trabajo en una empresa que tiene o sea su sede principal es en Reino Unido entonces pues claramente ayer no no es festivo en Reino Unido entonces Ayer tuvimos una reunión porque yo trabajo en la parte de o sea dirección de tecnología e Innovación pero en México Entonces yo reporto directamente al Reino Unido entonces pero ahí les va es que esta empresa está invirtiendo
(03:39) mucho mucho mucho en en venir a México pero también ahí les va o sea yo creo sinceramente yo creo que cuando es que cuando nosotros o sea nosotros Por el simple hecho de ser mexicanos a veces como que bueno a m me pasó cuando entré primero a esa empresa me pasó que como que me daba un poco de inseguridad por o sea siempre crees que este universidades gringas o universidades extranjeras son mejores no que nosotros y y a veces sí pero normalmente o sea de todas las personas que yo he conocido poca gente nos gana a
(04:25) nosotros los de la UNAM en teoría o sea de toda la gente que yo he conocido entonces pero principio como que a mí me daba ese tipo como que de inseguridad de que Oye sales y y como que crees que no sabes nada no crees que no sabes cómo Cómo aplicar las cosas crees que no sabes nada y este y sí pero no O sea poca gente realmente poca gente nos gana a nosotros en teoría y a lo que voy Es que este esta empresa de Reino Unido o sea bueno todas las empresas que son extranjeras a México a las empresas les es muy difícil venir a
(05:04) México Entonces siempre o sea las empresas gringas que vienen a México contratan personas mexicanas no O sea Nosotros somos o sea como mexicanos yo siento que somos difíciles de de impresionar y difíciles como de tratar de alguna forma No no puede llegar cualquier persona y y encajar con nosotros y encajar con nosotros así rápido saben entonces eh esta empresa de Reino Unido está invirtiendo mucho en en México para está invirtiendo mucho en México Entonces tenemos todo un departamento en México y esteo est la
(05:49) parte de dirección de tecnología e Innovación pero este hay un godines egresado del itam en la parte de Finanzas México a los de a los del itam es que saben cuál es el problema o sea el problema es que siempre nos quieren hacer menos y y a ver o sea Espero que no haya nadie Ah los de India Ah Espero que no haya nadie egresado del itam pero si lo hay pues no me dejará mentir verdad como que los del itam siempre nos tratan de hacer menos los de las escuelas privadas saben o sea si ustedes les preguntan a los de las
(06:29) escuelas privadas por nosotros los primero que le van a decir es que somos porros Ajá saben entonces total Ayer tuvimos una junta eh con Reino Unido y éramos el godí el godin es egresado del itam yo y los de Reino Unido entonces ahí les va Es que la diferencia de por qué Para empezar cuando ustedes traten con alguien de privada ustedes tienen que tener la certeza de que en teoría no les van a ganar no sus carreras sí son más rimbombantes O sea Ellos tienen ciencia de datos no tienen ciencias de la computación no pero
(07:13) literalmente 70 por del plan de estudios son estudios socioculturales de México y México megadiverso entonces en teoría realmente no les van a ganar la diferencia es que en el itam eh Y en las escuelas privadas y en las las escuelas por ejemplo gringas sí les dicen que que son los siguientes Steve Jobs que son los siguientes talentos y se la creen y y salen a la calle salen al al trabajo con esa confianza entonces la diferencia entre esa O sea la diferencia es esa confianza no porque este Tenemos que hablar con el director de Reino Unido y
(07:55) yo me la pasé real eh o sea real 15 minutos viendo o sea antes de la reunión 15 minutos tratando de ver cómo le iba a sacar el tema de conversación y llega el godines egresado del itam llegó tarde o sea llegó como 5 minutos tarde y llega entra con su teléfono y este y estábamos platicando porque yo me tardé décadas en saber qué preguntarle para entrar en el tema de conversación y ya y le pregunté que que cómo había estado que todo eso y me dijo que se había comprado un coche nuevo y llega el godí y se regresó del
(08:28) itam y le dice a qué coche te compraste y entró a la plática así entonces la diferencia no crean que es este y no se dejen sorprender por esas cosas chances sí tienen mejor carisma que nosotros pero teoría Nunca van a tener mejor teoría que nosotros Entonces no se dejen sorprender por por cosas así chiquitas y también por eso no dejen que los ayudantes les digan o sea los traten de hacer menos porque si hay un buen de ayudantes que los tratan de hacer menos y que les tratan de decir ah Oye pues o sea de alguna forma les dic
(09:03) No pues es que este yo trabajo y por eso tengo más razón que tú no O sea realmente yo sí creo o sea realmente yo sí creo que ustedes son unos verdaderos talentos Entonces si alguien si algún ayudante o algún profesor les dice lo contrario la neta No le crean porque quieren hacerlos menos y y quieren que cuando salgan o sea los ven como competencia Entonces ustedes no les hagan acaso Y esa es la principal diferencia no ustedes tienen más teoría que todas las personas que yo he conocido entonces créanse y tengan confianza en ustedes y
(09:41) sí O sea no se dejen sorprender porque un godí es egresado del itam llega con mucha más confianza que ustedes y este Exacto Ajá no les da pena porque yo o sea en la escuela les dicen que que son genios que son talentos Y aunque no lo sean se lo creen y a nosotros nos dicen Oye te vas a tardar 30 años en acabar la carrera pues yo ya trabajo y tú no saben o sea la principal diferencia es que a nosotros nos ven como competencias por toda la teoría que saben realmente saben muchísima teoría Entonces no les crean a la gente que les
(10:19) diga que no la verdad o sea los ven como competencia y nada más quieren que que no no entonces Oigan ya les nada más hay un equipo que lo voy a ver al final de este de la reunión pero todos los demás ya ya les califiquen dudas de su calificación califica no bueno si tienen dudas me mandan un mensaje o se quedan igual al final de la reunión si quieren mientras eh Por si tienen dudas me avisan va Okay entonces la idea de hoy es repasar la parte de visibilidad ver este la parte de modelo de memoria de
(11:25) Java y este la diferencia y cuando usar Bat Cuándo usar los candados y Cuándo usar synchronized o sea Cuándo usarlo de forma correcta cuando ustedes estén implementando algo concurrente y este las diferencias y qué problemas se solucionan Con volatile que no se solucionen con synchronized y que no se solucionen con candados y viceversa no les parece o no les parece miren ya vamos en la semana seis entonces ya les falta menos e Okay vamos a empezar con la parte de visibilidad esta parte este tiene mucho que ver con la parte de volatile de
(12:12) synchronized y de y de los candados No volatile aquí lo que usamos para la parte de visibilidad es e cuando Y por qué las variables las pueden ver los demás o no las pueden ver los demás no una característica muy importante o un punto muy importante que ustedes tienen que saber es este cuándo O sea tienen que reconocer las variables que van a poder ver todos los demás de forma inmediata o sea un tipo como de registros que la maestra me dijo que ya estaban viendo snapshots no Entonces algo simar si se dan cuenta en los snapshots lo que
(13:02) les importa es eh reconocer los registros que y la forma en la que van a ver los demás todas las actualizaciones de cada variable Entonces eso es lo que les va les va a importar cuando ustedes estén implementando algo y este quieran saber si es con volatile con un candado o con synchronized lo que ustedes tienen que saber es que tienen que reconocer las variables que este necesitan O sea que las actualizaciones deben ser visibles para todos no Entonces ustedes van a tener esto no y por ejemplo acuérdense que B
(13:53) qué les decía vola qué les garantiza vola la visibilidad muy bien Ajá y Y qué visibilidad les garantiza Exacto muy bien José muy bien zuriel muy bien Sí entonces lo que ustedes lo que les garantiza bola imagínense que tienen acá su estado uno de la variable no imagínense que la variable fue cero y este luego alguien actualice la variable y tiene un estado dos lo que les va a garantizar volatile es que o todos Vean este o todos Vean este sí O sea que no haya inconsistencias en los datos que algunos hilos pueden ver el estado uno y otros
(14:53) hilos puedan ver el estado dos o vean un estado intermedio entre la actualización nada lo que les garantiza volatile es cierto tipo de este igual como como atomic no les garantiza cierto tipo de atomicidad en donde ustedes pueden garantizar o sea ustedes tienen la la garantía de que si una variable es volati y se actualiza este todos los demás van a poder ver esa actualización o todos van a ver un estado Antes de esa actualización sí Enton ustedes pueden tener esta garantía con volatil que pueden ver no ven ustedes no hay forma
(15:35) de que haya hilos que estén acá no O sea que uno esté aquí otro esté acá otro está acá otro esté acá saben que estén en diferentes tipos de de la transición no se puede eso les garantiza volatile Y de cierta forma también se los garantiza atomic pero ese es otro otro rollo no Entonces por ejemplo si se da cuenta y nada más para repasar Oigan cuándo entregan su tarea hoy le entregan verdad ya la acabaron no Ah muy bien Ven les digo ustedes son unos talentos bueno si tienen dudas las revisamos ahorita eh Bueno entonces nada más para repasar
(16:31) esta parte si se acuerdan acá tenemos nosotros nuestra variable que no es volatile incluso vamos a ponerlo en rojo Ajá Entonces tenemos nuestra variable que no es volatile y nuestra variable que sí es volatile entonces una de las preguntas de su tarea era si en esta misma o sea en esta en en esta ejecución se puede que hay un hilo que divida entre cero no esta parte de acá entonces para que divida entre cero significaría que x fuera 0 no entonces imagínense que tienen un hilo a o se tienen dos ejecuciones no tienen un hilo
(17:16) a y tienen un hilo B entonces para este punto vamos a verlo así para que sea un poco más como que gráfico imagínense que el hilo a está en la parte de writer thread no n Vamos a ponerle writer Entonces está en la parte de writer y tiene writer y luego lo que va a haer el hilo a es que primero se va a dormir y después va a llegar una vez que se duerma después va a actualizar x = 1 y después va a poner su bandera la bandera en true no Uy se ve bien feo vo a ponerlo en true y mientras tanto va a estar el hilo B acá y va a estar
(18:18) ejecutando reader Pero va a estar ejecutando reader y esto lo va a hacer mientras la bandera sea false entonces va poder dividir hasta este punto de acá sí si se dan cuenta tanto x como la bandera e son variables compartidas no entonces son variables a las que tienen acceso todos los hilos entonces una vez que la bandera se ponga en true va a leer el hilo B va a leer que flag es true y lo que va a hacer es y ya va a ser la división no va a obtener y el problema es que es lo mismo que les decía si ustedes lo que les garantiza
(19:08) volatile es que ustedes puedan ver o un estado o el otro Si no tienen volatile ustedes no tienen la garantía de que puedan ver un estado u otro no O sea ustedes pueden tienen la certeza de que no saben qué va a haber cada hilo No eso es lo que saben literalmente saben que no saben queé va a pasar entonces Bueno no tanto así Pero puede pasar que el hilo a haya actualizado x a 1 y puede pasar que el hilo B todavía no vea esa actualización por qué Si ve por qué sí puede ver la bandera y por qué puede pasar que lea por ejemplo O sea que acá
(19:53) lea x = 0 por qué puede pasar eso puede pasar o no puede pasar para empezar si puede no puede no puede Por qué no puede o por qu sí puede por el volatile Ajá vas por ahí vas por ahí pero acuérdate que x no x no es volatile x no es volatil o sea van por ahí van por ahí nada más que acuérdense que x no es volatil o está tal cual está aquí entonces puede o no puede pero H no reacomoda Entonces si puede ser cero no entonces pueden no actualizarse en los demás ilos antes que la pregunta era si puede pasar esto de aquí
(20:58) que este la bandera O sea que b a actualice tanto x como la bandera y b nada más vea la actualización de la bandera y no la actualización de X pero José decía pero vola no reacomoda Ajá sí exacto no está reacomodando es como más bien eso que si puede pasar que nada más vea la actualización de la bandera y no la actualización de X se puede o no no se pueda Ajá van por ahí van por ahí van muy bien lo que Ah muy bien melicia lo lo que Mel está diciendo y lo que ustedes están pensando es es algo e como la lineación no entonces Y eso está muy
(21:54) bien no significa que sí entendieron la linealización entonces y Exacto van muy bien imagínense o sea va por ahí a pesar de que x no es vol la bandera garantiza que lo que pasa antes será visible para los demás Exacto Entonces pero este Bueno volatile A veces puede garantizar o a veces puede no garantizarlo no O sea lo que ustedes siempre están seguros con volatile es la parte donde o sea imagínense que x sea volati vamos a empezar desde x es volati si x es volatile ustedes van a tener la certeza de que tanto tanto x como la bandera van a ser
(22:47) vistos por todos porque acuérdense que volatile lo que les está diciendo es que no puede pasar que eh que alguien vea una actualización diferente o sea imagínense vamos a hacer esto para acá y vamos a hacer esto así okay imagínense que ustedes tienen en writer tienen algo eh donde ponen sus variables no se imaginense si así b c d X Y todas la actualizan en uno y imagínense que todos empiezan con cer0 no O sea a = b = c = d = x ig a 0 no pero imagínense que x es la única que es volatile no imagínense que x es la única
(23:46) que es volatil volat ahorita regresamos al otro ejemplo siento que este es más como que fácil de ver y luego tienen reader y tienen a prima B prima c prima d prima e prima imagínense que tienen x a b c d va entonces la variable x es volatile y es la única que es volatile puede pasar que o sea para empezar Acá por ejemplo tienen que a está después de vola no aj entonces acá tienen la actualización de
(24:53) volatile y acá tienen B prima puede pasar o sea siempre va a ser uno o sea B prima por ejemplo acá puede ser igual a cero por ejemplo Ajá por qué Muy bien por pas después de X muy bien entonces Exacto lo que ustedes van a poner es que justamente eh volatile o sea acá esto pasa después
(25:59) de cero antes Ajá Exacto Entonces volatile como decía Luis creo no solo hace este registro de este de acá y este de acá no lo que hace es que mantiene el orden de todas las escrituras que preceden a x entonces este siempre va a ser uno sí y luego por ejemplo se puede que este sea uno y este sea cero por qué no porque la escritura debe preceder la de
(27:08) X Exacto bueno va por ahí pero lo que tiene batel que justamente por eso les quería poner Este ejemplo es que volatile lo que les dice es que mantiene el orden no no les dice que mantiene todo el bloque les dice que mantiene el orden y si se dan cuenta a se actualiza antes que B entonces a pesar de de que la escritura de B preceda a la de X la escritura de este B se escribe después de a no O sea B se escribe después de a Entonces ese orden sí puede pasar no al revés no O sea no puede pasar que este sea cer0 y que este sea uno porque batel
(27:53) justamente lo que hace es que mantiene el orden de acá para acá no no puede pasar así entonces bate lo que hace es que mantiene el orden de las operaciones que lo preceden si te das cuenta aquí x es volatil y una vez que se actualiza volatile se actualizan o sea mantiene el orden de cómo se actualizaron estas no las actualiza en bloque O sea no llega y actualiza todo el bloque no llega y y actualiza en orden entonces Una vez que se tiene volatile Tú tienes la certeza de que primero todos van a ver la actualización de a luego todos van a ver
(28:40) la actualización de B de c y de D pero en ese orden Porque en ese orden fue como pasaron las operaciones que preceden a la a la variable de volatile pero volatile no te O sea no te garantiza que tú este metas todo el bloque O sea que una vez que tú tengas volatile no te garantiza que todas ya van a ver estas actualizaciones de bloque lo que te garantiza es que vean el orden no que todas vean primero que a se actualizó luego que B Se actualizó luego que c se actualizó y luego que d se actualizó Sí entonces por ejemplo si
(29:20) llega un hilo diferente que sería el hilo b y llega el hilo b y pone acá Este puede revisar bolat Te garantiza que primero todos vean que a se actualizó Entonces si a es igual a 1 ha una actualización para todos los hilos de X antes que a en este caso Cómo cómo cómo Ah sí sí sí sí de X antes que a en este caso sí Exacto porque es volati después de entonces Esas actualizaciones exacto no garantiza muy bien entonces lo que garantiza volatile nada más es las que preceden no no las que siguen entonces ahorita lo importantes que tienen operaciones que
(30:23) preceden entonces e Exacto como dice eh Eduardo primero se hace volatile o sea estas imagínense que estas ya las hizo un hilo pero todos los demás están O sea imagínense que es un proceso de acá Acá hay un hilo que está en proceso acá otro que está en este proceso otro que está acá otro que está acá otro que está acá en fin tienen varios o sea cada hilo está actualizando de diferente forma ya sea porque hay retrasos ya sea por cualquier cosa no entonces Una vez que se actualiza volatile lo primero que hace es que todos ven esta
(31:04) parte de acá y una vez que todos vean eso volatil va a proceder a ordenar pero de arriba para abajo no O sea en orden entonces lo que va a hacer es que primero va a ver o sea va va a garantizar que todos vean que a es = 1 luego va a garantizar que todos vean que B es igual a 1 Entonces si puede pasar que a sea igual a 1 y b sea igual a 0 porque no lo hace en bloque no primero garantiza que todos vean que AC ig a 1 pero esto no significa o sea esto no implica que todos ya estén viendo que B sea igual a 1 No si por ejemplo pasara esto Esto sí
(31:49) no puede pasar por qué Por qué no puedo pasar esto si se podría divir entre C en ese caso Ah a eso vamos a eso vamos pero no se Qué valor se actualizó a ver Ahí voy voy en porque se después de B muy bien los hilos sol saben que se actualizó pero no saben a qué valor se actualizó no sí lo saben o sea cuando cuando ya saben que se actualizó ya saben el valor al que se actualizó Ajá Imagínate que este ya está así no O sea tu Ah Exacto sí vas bien Luis exacto no se puede justamente por lo que dices entonces y por lo que dice
(32:50) Eduardo lo que tienen acá es que lo hace en orden Entonces si se dan cuenta si actualizaron primero c antes que B eso no está en orden No acá el orden es que primero va B antes que c entonces la actualización vola hace esto O sea vola imagínense que hace esto volatile primero hace uno y estos no sabe o sea todos están en diferentes estados luego hace esto luego hace esto y así sucesivamente sí lo ven eso es lo que hace volati que los va actualizando en orden y mantiene las el orden y las actualizaciones de los que
(33:35) lo preceden sí lo ven Ajá Entonces eso es lo que hace volatile y vamos a ponerlo por acá Entonces cuando nosotros est en esta parte de acá lo que hace es que eh la bandera es true Y entonces como la bandera es true pero ahí les va e puede haber Race conditions o Data [Música] races a sí s puede bueno este puede haber databases Porque lo que hace volatile es que volatile asegura la visibilidad no pero no no asegura la lectura y
(34:41) escritura entonces varios pueden estar leyendo y escribiendo al mismo tiempo que las exacto no hay candaditos muy bien entonces lo que está haciendo Es que garantiza la visibilidad por eso esto funciona por eso esta parte de acá funciona Pero como dice Luis no hay candados no hay ninguna forma de que garantice que no se escriban o lean al mismo tiempo entonces sí puede haber Data races entonces en esta parte de acá la bandera lo que hace es Es que mete o sea una vez que alguien vea que la bandera es true lo que va a
(35:24) hacer es una primitiva de sincronización débil muy bien Exacto Entonces lo que va a hacer es que la bandera una vez que vean que la bandera es true vola se va a asegurar de que todos vean eh en orden cuando x es O sea que vean en orden todas las actualizaciones que hubo antes pero ahí les va puede pasar que alguien vea la bandera y este bueno puede pasar que no pasa que alguien vea la bandera y que un hilo se meta entre esos eh entre esos espacios vacíos Pero por qué no se puede meter en esos espacios vacíos porque este justamente lo que hace
(36:24) volatile es que los actualicen orden no sí lo ven más o menos no lo puse dos ve orden orden de Sí cuando ustedes o sea bat lo que hace es que garantiza o sea primero c flag y después x sí exacto no Bueno o sea primero imagínate en el hilo a cambia x y luego cambia flag tal cual como está pero respecto a visibilidad Ah Sí bueno todos los demás hilos puede ser que por ejemplo el hilo B si haya visto que x y que x es ig 0 entonces Una vez que se se cambia la
(37:29) bandera esta se cambia para todos y cuando se cambia la bandera la bandera garantiza que se actualice todo lo demás O sea garantiza que todos los demás vean que x ig un en el orden en el que en este orden garantiza la visibilidad en este orden por eso acá puede pasar que por ejemplo que a O sea que B prima se igual a 1 mientras que igual a garan el actualizaciones de si lo ven muy bien entonces bola acuérdense que sirve para la visibilidad y es a lo que vamos
(38:36) no Entonces para empezar e Java no garantiza la linealiza bilidad ni la consistencia secuencial no cuando ustedes leen Campos o o escriben registros Ah Al final a ver pues no se puede dividir entre cero porque lo que garantiza vola es básicamente que o sea una vez que tú leas la bandera todos ven que la bandera es true Y entonces una vez que todos los hilos o se Imagínate que ahí están todos los hilos una vez que todos los hilos vean que la bandera es true básicamente todos los hilos van a empezar a ver que o sea mantiene la linealización entonces
(39:34) mantiene el orden de todas las escrituras que preceden a x y como x precedió a a la bandera lo que va a hacer es que va a ir garantizando que todos vean que x es = a 1 Entonces cuando llegues a este punto todos van a ver que x es igual a 1 y básicamente Y si ambas son volate Sí si ambas son vol tampoco se puede dividir entre cero porque eso es más fuerte porque les garantiza eh que tanto o sea esto les garantiza que se mantiene la linealización y la eh visibilidad de acá para arriba y esto les garantiza que se mantiene de acá
(40:17) para arriba Entonces les garantiza o sea es más fuerte porque les garantiza que los hilos justamente van a ver como decía Eduardo porque primero acá Todos los hilos ven true Entonces si es volatile todos los hilos van a estar así y luego van a ver la actualización sí lo ven esto sucede sin importar que batel no cumple con los dates de lectura y escritura sobre las demás variables que no son volatile que mantenga el orden Sí pero justamente como volatile no mantiene los Data races e lo que vas a tener va a ser
(41:09) inconsistencia de datos Entonces si tienes inconsistencia de datos donde más hilos quieren bueno en este caso no sucede pero si tienes más hilos donde todos los hilos quieren estar como tú dices escribiendo sobre unas variables que no son volatile va a pasar como en el contador en el contador concurrente que ustedes hacen sin sin candados no cuando ustedes hacen un contador concurrente sin candados eh lo que tienen es que pues eso no Data races entonces puede ser que dos entren al mismo tiempo y en vez de contar a los dos o en vez de
(41:45) contar a los cinco que entraron al mismo tiempo nada más contó a uno entonces va a ser lo mismo que va a pasar acá Es igualito igualito igualito vas a tener tú eh o sea todos los demás van a ver eh el batel garantiza que vean el Cómo se llama el evento final o bueno el estado final de una variable pero este estado final de la variable va a tener inconsistencias porque puede que dos bueno dos hilos hayan querido actualizar por ejemplo x Imagínate que dos hilos quieren actualizar x uno lo quiere actualizar a x = 2 y otro lo quiere actualizar a x =
(42:24) 3 y otro x = 4 al final lo que vas a tener es que nada más se va a contar una de esas actualizaciones y vas a tener x = 1 o bueno qué dos vas a tener x es ig a 2 y todos van a ver o sea sí se va a mantener la la visibilidad y la linealización pero para x es ig a 2 y esto ya te generó un Data Race Por qué Porque tú ya hiciste o sea ya había otro hilo que había hecho x = 4 pero como entraron al mismo tiempo y generó una Data x se actualizó a 2 y todos van a ver que x es igual a 2 nada más que ese no era el valor el valor correcto Entonces si
(43:08) esto siempre se garantiza nada más que con databases vas a tener valores pues incorrectos no muchas veces sí sí Entonces ya va eh Java No garantiza ni la linealización ni la consistencia secuencial O sea cuando ustedes están leyendo están escribiendo registros de objetos compartidos de variables compartidas o de cualquier cosa compartida Java no les garantiza la linalis habil eación ni la consistencia secuencial por eso era muy importante que ustedes lo conocieran porque ustedes tienen que garantizar en el diseño la
(43:51) consistencia secuencial y la linealización y tienen que hacerlo de forma o sea de una forma muy precisa porque Java no se los garantiza y Java no se los garantiza básicamente por este el momento de compilación no o sea las las optimizaciones que tiene el compilador el compilador no sería tan eficiente Si tuviera que garantizar la linealización y la consistencia secuencial entonces básicamente estas eh cosas que hacen que sea eficiente el compil ad e O sea la asignación de registros la eliminación de de de Sub
(44:36) expresiones eliminación de lecturas redundantes eliminación de cualquier cosa redondeos todos esos e los reordenamientos que hace el compilador o sea el momento de compilación cuando esté reordenando eh van a ser como que de cierta forma invisibles o de cierta forma no los va a poder Eh pues garantizar entonces básicamente eh cuando ustedes están programando en Java de forma concurrente un hilo puede ver lo que está haciendo el otro hilo y el otro hilo puede estar estar viendo lo que hace el otro hilo justamente por
(45:19) esta parte del proceso de compilación entonces básicamente cada o sea todos los hilos pueden estar observando ejecuciones en otras pilas de ejecución e o sea fuera de de su pila de ejecución de este hilo Por qué por la forma en la que ya va a estar reordenando todas las asignaciones de memoria y las reasignaciones de memoria no pero yaa sí satisface que e si las ejecuciones secuencialmente consistentes de un programa tienen y mantienen ciertas reglas entonces cada ejecución de ese programa va a seguir siendo potencialmente consistente si lo
(45:59) ven entonces Java no les garantiza la la cómo se llama Java no les garantiza ni la lineab iliza ni la consistencia secuencial pero Java sí les garantiza que si un programa e o si una ejecución es secuencialmente consistente y sigue ciertas reglas entonces todas las ejecuciones de este programa van a seguir siendo secuencialmente consistentes entonces mientras ustedes eh diseñen una ejecución secuencialmente consistente ya B sí les va a garantizar que todas sus ejecuciones sean este secuencialmente consistentes
(46:39) no entonces ahí les va sí Bueno yo creo que a ver Vámonos a la parte de este synchronize volatile y eh los candados creo que esta parte es un poco más rápida para poder regresarnos a esta parte de el modelo de memoria de Java les parece o no les parece entonces básicamente todo o sea ustedes no van a resolver todo con candados no hay ciertas partes como decía Eduardo como decía como decían ustedes hay ciertas partes donde ustedes nada más quieren eh verla garantizar la visibilidad o garantizar ciertas cosas no garantizar
(47:33) visibilidad garantizar eh la secuencialidad en ciertas partes Entonces cuando ustedes o sea los candados son algo muy poderoso Entonces cuando ustedes necesitan otras cosas lo que van a hacer van a utilizar bloques sincronizados y van a utilizar campos de volatile va entonces básicamente en Java por ejemplo los bloques sincronizados permiten que un solo hilo acceda a un recurso compartido a la vez es algo como eh mantiene la exclusión mutua pero lo que hace synchronized es que utiliza un candado implícito entonces acá abajo de lo que
(48:15) está haciendo synchronized es que está manteniendo un candado y también es posible usar candados o sea explícitos como el peterson el Baker y todos los que ustedes ya se saben pero Y hay muchos que que ya va ya ya tiene implementados pero esos son candados explícitos si ustedes utilizan synchronize están utilizando un candado implícito y independientemente de esto ambos mecanismos aseguran que este cuando un hilo o varios hilos quieren acceder a un campo protegido ya sea por por synchronize o por un candado o por
(48:52) eh cualquier cosa las lecturas y las escrituras van a ser linealiza Y esto es lo mismo o sea y Java les va a garantizar esto porque e por por por su ejecución relajada que tiene Java Al momento de compilar va a ser todo un desorden Pero si ustedes están garantizando la linealización con synchronized o con algún candado javas se los va a garantizar o sea javas se los va a mantener entonces básicamente lo que tienen es que las las cosas aparecen en un orden Eh pues como que coherente y sin sin que no se cumpla la exclusión mutua
(49:32) no El problema es que sincron lo que hace si ustedes meten syncron si ustedes meten a todo su programa syncron Qué pasa Qué pasa si ustedes meten a todo su programa O sea a todo su programa concurrente y Exacto todo es secuencial y también se hace lento Félix Sí sí muy bien José muy bien Luis se hace lento por qué Porque se vuelve secuencial no no tiene la rapidez que tiene si varios están trabajando al mismo tiempo entonces básicamente o se imaginen que ustedes Acá tienen su clase contador que es un contador normalito pero ustedes lo
(50:19) quieren hacer de forma Este concurrente pero sincronizado entonces acá lo que ustedes van a poner es que o sea la parte en la que tienen que tener cuidado justamente es la parte en donde ustedes están aumentando este contador entonces la única parte donde ustedes van a poner sincronize es aquí donde ustedes van a aumentar increment Uy donde ustedes están incrementando el el contador acá tiene que haber synchronized O tiene que haber un candado Por qué Porque si no se vuelve como decía Eduardo una Race condition si
(51:06) lo venon entonces básicamente tienen esta parte de acá y si ustedes le meten synchronized acá o sea imagínense todo se vuelve secuencial pero aquí como lo único que están haciendo es justamente eh aumentar básicamente ustedes están haciendo un contador secuencial porque el contador está o sea cuando un hilo va a incrementar algo se tiene que formar de forma secuencial no y cuando ustedes utilizan synchronized acuérdense que es una palabra reservada y synchronized se utiliza eh para garantizar que solo un Nilo a la vez puede ejecutar un bloque
(51:52) de código o método protegido pero acá lo que hace es igual que como es lo mismo que se hiciera un candado bloquea el acceso a ese recurso para otros hilos y para empezar o sea esto sí Es segura la exclusión mutua si si estamos hablando de un recurso compartido Y ustedes o sea les va a servir mucho cuando ustedes necesiten proteger este operaciones críticas o secciones críticas eh todo eso y los pasos no puedan ser interrumpidos por otros hilos Pero a él les da un bloque sincronizado es algo muy poderoso y puede ser un candado
(52:32) porque un bloque sincronizado tiene un candado implícito pero el bloque sincronizado lo que les dice es que eh lo protege todo entonces ustedes nada más cuando ustedes meten un bloque sincronizado no solo les dice que va a dejar a un solo hilo eh modificar una variable también les dice que va que un solo hilo pueda leer esa variable si lo ven entonces tienen que ser Muy cuidadosos cuando utilizan esta parte de synchronized porque synchronized lo protege muchísimo y además el candado implícito que tiene synchronize puede no
(53:14) ser siempre tan eficiente para sus necesidades Entonces ustedes tienen que evaluar si quieren proteger de esta forma a la parte de acá synchronized Tiene un candado implícito pero es la diferencia entre synchron Cuál es la diferencia entre syncron y un candado que synchronize protege la escritura y protege esto protege la escritura también bueno garantiza la exclusión mutua no Pero además cuando ustedes están implementando un candado ustedes pueden y este es un candado implícito pero también se cumple la exclusión
(54:00) mutua para la visibilidad entonces y en los candados si se dan cuenta se acuerdan de cómo era nuestro algoritmo de peterson lock había muchas variables que eran variables compartidas entonces todas estas variables compartidas las podían ver todos los hilos pero en syncron no en syncron no hay variables o solamente un hilo a la vez puede leer escribir cualquier cosa todo lo que esté protegido con syncron Entonces esta es la principal diferencia la visibilidad y este la exclusión mutua la cumplen las dos nada más que tienen
(54:43) que ser Muy cuidadosos porque si le meten synchronized de una forma pues saben o sea si abusan de synchronize van a tener un programa secuencial synchronize es según yo sí Según yo sí Y eso es muy importante o sea su su modelo pram es muy importante que lo revisen porque si te das cuenta Eduardo no todos los candados tienen el mismo modelo pram entonces esa es la parte justamente que difiere de synchronized y de los candados sí lo ven el modelo que están utilizando tanto para la visibilidad como para la escritura entonces y la diferencia con
(55:40) vola nada más para para terminar esta parte Bueno yo creo que lo vieron en el ejemplo pero básicamente volatile se usa variables o se se usa para se pueden combinaron con b O sea que dentro de dentro de un método syncron puedas meter un volatile o sea una variable vol pues o sea s puedes pero aj o sea syncron ya te garantiza que Exacto a no tiene como que o sea sería puedes hacerlo sabes o sea puedes pero ya te garantiza queada más un hilo pueda acceder escribir y actualizar una variable Entonces si tú metes volatile o
(56:34) sea syron te garantiza la linealización y batael también te las garantiza pero solo para visibilidad Pero syncron te lo garantiza para visibilidad eh o sea para lectura escritura para lectura y escritura y bola nada más para la lectura Entonces si ya tiene synchronize que te garantiza para la lectura y la escritura y y metes batael pues o se estarías como que como que repitiendo de cierta forma sí me explico pero pues a ver si puedes No nada más que no O sea no no se me ocurra ahorita un ejemplo donde pueda o sea donde pueda ser útil
(57:16) que metas un bol Aon synchronize pero sí Si lo encuentran me avisan y les doy un punto extra entonces volatile básicamente e se usa para variables que pueden ser accedidas y modificadas por múltiples hilos si se dan cuenta volatile es nada más para variables compartidas no tiene mucho caso que le metan volatile a una variable local porque este volatile lo que hace es que e asegura en los Estados O sea que se mantenga o un estado u otro para todo los hilos no asegura que las O sea que las escrituras y actualizaciones a estas
(58:03) variables sean visibles de inmediato en todos los hilos no sin necesidad de bloquear el acceso a la variable entonces ahí les va Lo diferente Es que est no bloquea el acceso a la variable y es como decía Eduardo y Luis creo el acceso a la variable esto qué implica si no bloquea puede tener r digo este si lo ven Entonces esto no garantiza la exclusión mutua Este sí garantiza la exclusión mutua Este sí garantiza la exclusión mutua este no garantiza la exclusión mutua entonces este nada más lo van a usar cuando quieran garantizar la
(58:47) visibilidad no y es muy importante o sea acá es muy importante que vean que existe ris conditions y que no Gar di la exclusión mutua porque a veces eso les puede perjudicar y básicamente cuándo lo van a usar lo van a usar Cuando necesitan asegurar que un hilo siempre vea el último valor actualizado de una variable por otro hilo no último valor actualizado último valor actualizado esto es cuando lo van a usar sí estos dos nada más difieren en su modelo de pram y este lo van a usar para cuando quieren garantizar nada más
(59:27) que un hilo pueda acceder a la lectura y a la escritura y este No necesariamente bloquea la escritura no bloquea digo eh la lectura la lectura de las variables sí lo ven y y batel también la van a usar nada más cuando la operación sobre la variable simple no y cuando no requieren sincronización de acciones más complejas sinc decir lo quea la lectura de lo que está dentro Sí y los candados No si se dan cuenta en los candados hay muchas variables compartidas para los hilos Sí por ejemplo en el peterson está la variable
(1:00:15) compartida ahí sí entonces vemos más ejemplo de bola de la siguiente clase va Entonces hasta aquí tienen dudas no va Cualquier cosa me avisan Sí entonces revisen su calificación de su tarea dos si tienen dudas me avisan revisen si tienen dudas de de esta tarea que se entrega ahorita me avisan y pues tengan una bonita semana va Nos vemos el jueves para seguir viendo Esto sí y me quedo con el equipo que tenía dudas de su calificación gracias a ustedes Bye [Música]
