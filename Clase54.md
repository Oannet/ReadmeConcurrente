(6) Clase 54 2024 10 15 - YouTube
https://www.youtube.com/watch?v=Y-TL0QbrhIs

Transcript:
(00:00) Entonces al final lo que ustedes van a tener si se dan cuenta lo que ustedes van a tener es en cualquiera de los dos casos en cualquiera de los dos casos lo que ustedes van a tener Es que r0 está escrito a algo y R1 está escrito a algo Esto es lo que van a tener en cualquiera de los dos casos Si lo ven acá y acá llegan al mismo resultado que es lo que les ponen Uy bueno llegan al mismo resultado que es justamente este de acá Entonces el protocolo de consenso lo vamos a ver por eso o sea quería demostrar esto con ustedes la clase
(00:41) pasada porque los protocolos de consenso lo que lo que les dice es que cuando llegan al resultado final cuando llegan a su estado crítico ustedes van a tener un estado de ese ejecución y en base en ese estado todos deben saber quién se movió primero si ustedes ven o sea ustedes ustedes si ustedes yo les doy esta este resultado de estado final ustedes pueden decirme si a fue primero o b fue primero ustedes de ahí pueden exacto no pueden sacarlo muy bien entonces de ahí ustedes no pueden saber Sí muy bien si ustedes nada más les dan eso ustedes no
(01:31) pueden saber quién se movió primero no y es lo que vamos a tener cuando estemos revisando protocolos de consenso ustedes quieren que el resultado final les diga quién se movió primero si ustedes ven el resultado final y ustedes ustedes no pueden determinar quién se movió primero entonces su protocolo de consenso no es un protocolo de consenso si el resultado el método de de su protocolo de senso les da un resultado final donde ustedes pueden decir quién se movió primero Entonces si resuelve el consenso y de
(02:09) ahí ya tienen que demostrar que resuelve para dos hilos y generalizar para que se resuelva para infinitos hilos es una técnica muy similar a la que hicimos eh la clase pasada Porque si se acuerdan lo que nosotros hicimos es nada más demostrar que para dos hilos no se puede eh resolver el consenso utilizando solo registros atómicos y de ahí La idea era generalizar lo a un número infinito de hilos para decir que para un número infinito de hilos no se puede resolver el consenso usando solo registros atómicos es lo mismo lo que nosotros
(02:44) vamos a hacer casi siempre es primero ver que se cumple para dos hilos y de ahí generalizar que es la forma más eh o sea el acercamiento que a mí se me hace más más fácil de entender Entonces esta es la idea si ustedes tienen un resultado donde ustedes no pueden determinar quién se movió primero Entonces eso no resuelve el problema de consenso si ustedes o sea imagínense que ustedes tienen su resultado imagínense que sea primero igual a a último igual a b imagínense que tienen de cierta forma generan un protocolo de consenso para
(03:25) que al final les diera esta parte de acá en base en esto O sea en base en este resultado final ustedes pueden decirme quién se movió primero O sea si el primero Ajá sí ahí sí Este Entonces si tienen un protocolo de consenso que les da como resultado algo así ese o sea ese protocolo sí resuelve el problema de consenso Entonces si ven La diferencia ustedes Acá tienen dos resultados diferentes de las ejecuciones Entonces cuando ustedes tienen Eh Esto de acá solo usando registros si ustedes lo ven ustedes no me pueden
(04:19) decir quién se movió primero y si ustedes ven este de acá pues claramente el que se movió primero es el que está en la variable primero no entonces de ahí ustedes sí me pueden decir Quién fue el que se movió Primero me explico Entonces eso es a a dónde vamos o sea para ahí esa es como que la lógica que vamos a seguir para eh hacer nuestros protocolos de consenso primero ustedes tienen que pensar la idea eh de cómo le van a hacer para que ustedes tengan eh o sea que ustedes tengan un resultado que les pueda decir
(05:01) a ustedes Quién fue el primero va dudas hasta acá de Qué es el consenso o protocolos de consenso seguros Okay Va entonces su primer ejercicio dice supón que tenemos una implementación de una cola fifo modificada con métodos en q y pic en la cual cada nodo de la cola encapsula el valor del elemento que es un entero o un buano no y un ID que inicialmente es os1 el método p consiste en devolver el primer elemento de la cola Sin embargo a diferencia de un método de que no lo elimina de la cola Entonces vamos a ver cuáles son las
(05:54) ideas importantes de acá tenemos una cola fifo Entonces esta cola fifo realmente no cambia lo único que se modifica o sea dice una cola fifu modificada porque agrega el método pic no pero realmente eh sigue siendo nuestra cola fifo normal que conocemos todos Entonces [Música] tenemos que cada nodo de la cola encapsula el valor del elemento y el ID inicialmente es -1 y el método p consiste en devolver el primer elemento de la cola entonces ahí les va Lo que la idea es que imagínense ustedes tienen una cola no tienen una
(06:41) cola entonces básicamente tiene acá uno dos 3 etcétera no n p no puede regresar nul no p sí puede regresar nul por bueno abajito de esto según yo les definen el método p y el método pic este regresa nul en alguno de los casos no O sea creo que si no vio nadie o sea si la cola está vacía regresa nul abajito de de este de esta parte les definen el método p y según yo sí se puede regresar n entonces bueno si mi memoria no me falla no entonces e la idea es que o sea ustedes en esta cola tienen el método pic y eh básicamente lo que va a hacer su
(07:41) método pic es que va a revisar eh el elemento les va a revisar el elemento y va a escribir el hilo que revisó ese elemento entonces además esta escritura pueden suponer que esta escritura es atómica entonces lo que va a hacer pic es que va a llegar va a revisar un elemento revisarlo no lo va a eliminar Como de que nada más lo va a revisar y va a escribir de forma atómica el elilo de que vio este elemento entonces pero é les va Aquí hay un problema Por qué Porque cuando ustedes estén haciendo eh p imag según yo si no me corrigen eh Pero según
(08:33) yo el método p lo que ha de la definición que está acá abajo es que escribe el ID entonces si yo hago pic acá lo que va a hacer es que el hilo imagínense que el que hace pic es el hilo a entonces va a escribir atómicamente el hilo a pero luego qué pasa si yo quiero este revisar este de acá tendría que hacer un dq y tendría que hacer otro pic entonces o sea pic realmente no lo elimina si lo ven Entonces si no lo elimina y yo hago pic pic pic pic pic lo que va a hacer es que va a estar Cómo se llama va a estar sobrescribiendo esta parte de el hilo
(09:20) que lo revisó y lo va a estar sobrescribiendo a todos los hilos que están revisando ese ese elemento de ahí Pero eso nos genera un problema porque el primer hilo que que lo revisó la variable que tenía al hilo que lo revisó va a ser sobre escrita no Entonces nos empieza a generar un problema Entonces vamos a pensarlo de esta forma pensarlo eh o sea esta parte todavía es es la idea Entonces no vayan a escribir esto en su tarea pero si el método pic el método p consiste en devolver el primer elemento de la cola
(10:02) Entonces cuál es nuestro problema Cuál era el problema que nosotros teníamos acá Cuáles son los problemas que que habíamos ahorita ahorita ahorita acabamos de decir de de pic cuál es el problema que tiene pic Ajá que sí que no hace deq que sobreescribe los otros hilos Exacto muy bien Eduardo muy bien Kenia e y muy bien Valeria lo que tienen o sea el problema que nosotros tenemos el principal problema es que nosotros estamos si hacemos pic y pic y pic sin hacer de que lo que vamos a revisar o sea si hacemos pic dos veces lo que
(11:00) esperaríamos es que hagamos pic y luego pic me explico Entonces nosotros lo que querríamos de pic es que haga la primera vez que hagamos pic lea el primer elemento de la cola y nos diga quién lo leyó y la segunda vez que hagamos pic revise que alguien ya leyó este elemento hagamos piic en el segundo o hasta donde no lo hayan leído y nos diga el hilo que lo le yo y la tercera vez que hagamos pic eh queremos que pic lea que alguien ya este leyó al primer elemento al segundo elemento Y entonces haga pic al tercer elemento y nos diga el hilo que
(11:44) lo leyó sí lo ven va entonces este para qué no sirve Quién fue el segundo en leer o usar pic sí solo nos interesa el primero pero si no lo hacemos así O sea buen realmente podrías omitir esta parte sí lo podrías omitir pero este lo o sea es como que una ampliación de pic porque al final queremos seguir usando pic y p lo que hace es escribir el hilo que leyó un nodo entonces p escribe el hilo que le yo un nodo lo único que nosotros queremos agregar es que si alguen ya leyó ese elemento se pase al siguiente para este para solo leer el primero o
(12:36) sea podrías modificarlo pero tendrías que modificar p y ahí ya no entraría en el ejercicio que les pide la tarea entonces O sea si realmente no nos importan estos hilos Pero al final queremos seguir usando pic no no podemos modificar p entonces lo que vamos a hacer el pic que nos funcionaría sería un p así sería un p que haga esto O sea que haga lo que ya hace Entonces qué hace devuelve el primer elemento de la cola elemento de la cola escribe atómicamente escribe atómicamente el ID del hilo luego eh revisa o sea Sí marca no
(13:38) marca este elemento elemento eh Como leído y vamos a ponerlo Ajá marquea este elemento como leído y este se comporta como deq si ya está marcado si ya está marcado Entonces si lo ven lo que nosotros el pic que nosotros nos da hace esto de acá pero para que nos Sirva y para que no tengamos el problema de sobreescribir e sobreescribir el hilo que lo leyó se vamos a poner que se comporta como un dq si ya está marcado o sea nos funcionaría que se comporte como deq si ya está marcado y que además marque un
(14:42) elemento como leído entonces o sea s lo ven hasta aquí sí va entonces lo que nosotros tenemos es que no podemos modificar a p o sea eso es una regla nosotros por el ejercicio no podemos p cuando sobreescribe no entiendo Ah okay Mira tú tienes Okay tienes la cola no Entonces tú haces Imagínate que el hilo a hace pic lo que va a hacer pic es que va a decir ah Oye o sea va a leer este elemento de acá va va a leer el elemento uno y va a decir o sea va a revisar el elemento uno y va a decir que el hilo a leyó a uno va eso es lo que hace pic
(15:39) pero luego Imagínate que después de eso llega B llega b y hace pic como pic no elimina eh pic no elimina el primer elemento nada más lo revisa lo que va a hacer es exactamente lo mismo va a decir pic eh Val a leer uno y va a decir que b leyo a un pero lo que están haciendo acá o sea esta parte de aquí lo que estás haciendo Es que estás modificando una variable eh que te dice quién lo leyó primero O sea esta variable a mira mejor lo ponemos así entonces lo que va a hacer p es que va a estar haciendo así entonces va a decir el primero fue a
(16:31) porque fue el que leyó este elemento pero cuando B lo haga pero p solo escribe qui lo leó su ID si el ID que tiene la cabeza es men1 no el nodo que inicialmente es un aj bueno el método p realmente no O sea eso es a lo que vamos lo que nosotros queremos es que p así pero si te das cuenta este método p y el que aparece en su tarea no revisa si el ID es men1 según yo a ver si no Ahorita abro su tarea si lo hace a ver dejen AB su tarea ya no me acuerdo de su método p comp ID men ah voy voy voy Ah okay Entonces nada más tenemos
(17:35) entonces p ya hace lo que nosotros queremos si es así dejen su tarea a ver lo que hace p es que llega llega p my ID obtiene el ID tiene el ID y comp men1 my ID Ah s Ok entonces lo que hace entonces básicamente ya s todo lo que necesitábamos Pero bueno no se comporta como deq si ya está marcado entonces lo que siempre va a regresar Es If
(18:41) men1 get si nosotros tenemos pic hacemos pic y my ID llega y obtiene el ID entonces obtiene el ID del nodo No si es la primera vez que lo hace obtiene el id-1 y si tiene If men ID entonces lo que hace es que return si es -1 regresa el primer noo de la cola sin eliminarlo return Head get y si es os1 entonces regresa n Okay entonces si se dan cuenta acá o sea está mejor no nosotros ya el problema que nosotros teníamos era si pic no O sea no marca estos nodos pero acá s los marca no los marca per s pero lo que
(19:44) hace es que llega agarra el ID de este del primer elemento y este si es men1 si es men1 regresa el primer nodo de la cola sin eliminarlo y si no regresa nul Okay entonces pues está mejor no ya no tenemos este problema de acá sí lo ven sí lo ven o o va otra vez otra vez okay Entonces básicamente nosotros tenemos este método pic tenemos nuestro método p y lo que hace p es que va a llegar y
(20:50) va va a obtener el primer elemento de la cola va a obtener el primer elemento de la cola entonces bueno el ID del primer elemento de la cola y todos los elementos en un inicio están marcados como -1 Y -1 entonces básicamente cuando nosotros obtengamos el primer elemento de la cola digo el ID la primera vez lo que va a venir es -1 Entonces cuando nosotros lleguemos vamos a hacer algo vamos a hacer un comparent set y vamos a decir Oye si la cabeza O sea si el primer elemento ah si el primer elemento compar set y el primer elemento
(21:55) -1 es igual o sea y es la primera vez lo que hace esta parte de acá es que revisa si es la primera vez que a Bueno no pero no lo marca entonces bueno básicamente lo que nosotros vamos a tener Es que va a revisar que el ID sea men1 si es menos un va a regresar la cabeza return Head no va a regresar el primer elemento que está en la cola El problema es que nuestro método P perc O sea ya tiene avance pero no cambia el ID entonces pero o sea con el comparan set lo marca con el ID y el ID va a ser -1 no bueno en el caso de que
(23:03) no sé Le voy a preguntar a la maestra porque si my ID es el ID del del hilo bueno s haría más sentido que es el ID del hilo si es el ID del elemento va ser menos un si es el ID del hilo si va No si haría más sentido que sea el ID del hilo Okay entonces si es el ID del hilo si es el ID del hilo si hace más sentido que es el ID del hilo Sí yo creo que haría más sentido que fuera el ID del hilo Sí entonces básicamente sí va a regresar la cabeza y va a marcar este ID con o sea va a marcar el elemento con el ID del hilo que lo haya visto
(23:55) Entonces nosotros tenemos cinco y si se dan cuenta esta parte de acá ya quedó esta parte de acá ya quedó y esta parte de acá ya quedó entonces O sea al marcar el hilo como marca el hilo como leído al marcar este el ID en la en el elemento de la cola porque si no ha sido leído si si ya fue leído va a regresar nul si no ha sido leído Entonces ya va a ser cuando este marque este elemento entonces es este marca va a ser esto de acá esto de acá sí sí sí hace sentido que sea el ID del hilo entonces nuestro nuestro pic ya no lo
(24:44) tenemos que modificar si lo hubiéramos tenido que modificar la idea era hacer un método eh que utilizara pic como método auxiliar para poder marcar el elemento como leído porque lo único que a nosotros nos faltaba era marcar el elemento como leído pero como pic ya marca el elemento como leído ya nada más podemos usar pic para hacer nuestro protocolo de consenso y de ahí ya nada más lo tenemos que demostrar para dos hilos Y generalizar entonces vamos a verlo no nosotros tenemos siempre empezamos con Class nuestra
(25:23) cola q consensus extens consensus eh protocol No entonces eh hacemos lo primero que hacemos Es que hacemos nuestra nueva cola Ajá hacemos nuestra nueva Cola y eh lo que nosotros queremos hacer para nuestro protocolo de consensos a donde nosotros lo vamos a hacer va a ser en decide no Entonces nosotros vamos a querer hacer un decide para poder decidir Quién fue el primer hilo que se movió entonces imagínense necesitamos un constructor no para poder hacer el en Ah sí pero como nosotros ya tenemos Este es un
(26:26) pseudocódigo nada más entonces De hecho no vamos a poner todos los los métodos que va a ser el protocolo de consenso porque nada más vamos a hacer el pseudocódigo para poderlo demostrar pues este nada más va a ser el pseudocódigo que vamos a usar como base para poderlo demostrar Por eso nada más Igual vamos a hacer des y aquí ya suponemos que tenemos nuestro constructor y todo eso y por eso nada más ponemos acá nuestra eh nuestra cola Pero entonces por eso nada más vamos a hacer design porque lo único que nosotros queremos es hacer nuestro
(27:01) seudocódigo para e para poderlo demostrar que es la parte fuerte del ejercicio Entonces nosotros nada vamos a estar haciendo el método deside y lo primero que hacemos Es tenemos o tenemos nuestro propose no propose vale Y lo que nosotros vamos a hacer es que vamos a hacer vamos a mandar a llamar a p sobre nuestra cola que es q Entonces vamos a ponerle y vamos a mandar a llamar p sobre nuestra cola entonces lo que va a hacer p lo que va a regresar p si se dan cuenta es el elemento de el primer elemento tenemos dos casas
(27:52) va a regresar el primer elemento va a regresar nul si ya está marcado y va a regresar el primer elemento si no Entonces tenemos que este manejar estos dos casos nosotros mandamos a llamar pic Pero dentro de p p nos puede resultar en dos casos Entonces si eh si p Resulta ser diferente a nul esto Qué significa si p Resulta ser diferente a nul Qué significa esto vamos a ponerlo Como comentario Ajá bueno si p resulta ser diferente a n esto quiere decir básicamente que este hilo
(29:00) eh ganó y marcó no y luego si p resulta Bueno sí a eso vamos pero primero tenemos que revisar e si es nul porque si es nul entramos a unos casos que entramos a esta parte de entramos actual y entramos a inicial y nosotros no queremos entrar a eso Si es nul nosotros queremos empezar a actualizar nada más si nosotros tenemos la garantía de que no es nul no entonces lo que nosotros vamos a hacer es que primero vamos a tener estas variables vamos a tener actual que va a ser nuestro e si p es nul si p no es nul lo que
(29:58) vamos a hacer es que vamos a guardar e buen tenemos nuas dos variables actual actual es el id thread thread ID get no Entonces tenemos eso y luego nosotros queremos revisar el ID del primer elemento de la cola Entonces nosotros antes de querer revisar el primer elemento de la cola tenemos que asegurarnos si eh si pic funcionó o no funcionó después de hacer pic vamos a hacerlo como que paralelamente nosotros queremos saber quiénes somos nosotros y luego Quién fue el primer elemento de e Quién fue el primer elemento que
(30:56) modificó pic o que hizo p entonces lo que nosotros vamos a hacer Ya si tenemos esto es que vamos a revisar si nosotros somos el mismo que el primer elemento que hizo p si es así nosotros vamos a regresar turn proposed actual no vamos a regresar a nosotros mismos y si no es as si nosotros no entramos en este caso entonces alguien más nos ganó y en específico nos ganó el primer elemento bueno el primer hilo que hizo el primer hilo que hizo p Entonces nosotros ya tenemos esto pero para
(32:00) nosotros eh hacer pic lo que o sea todos los hilos tienen que hacer pic porque no sabemos Eh si ya se hizo pic o si todavía no se hizo pic entonces lo que vamos a hacer es que vamos a hacer pic y vamos a revisar ahen aquí lo teníamos cuando nosotros hagamos pic lo que nosotros queremos revisar es si es nulo o no es nulo no entonces todo mundo va a ha ser pic y nuestra forma de revisar si es nulo o no es nulo entra esta parte de acá por qué porque nosotros cuando estemos haciendo esta comparación si nosotros nosotros no revisamos que pic
(33:00) no haya sido nulo si entramos a esta comparación o entramos a esta comparación Y si todavía nadie lo ha hecho eh si un hilo se adelantó y no terminó de hacer pic y fue el primero en hacerlo y Se está actualizando o sea esta parte se basa mucho en retrasos si nosotros tenemos este caso y dos hilos se retrasaron un hilo se adelantó y el otro se retrasó entonces puede pasar que esta parte eh lea Un regreso en -1 entonces acá lo que tenemos que hacer ya no me acabé pero acá lo que tenemos que hacer es básicamente
(33:43) revisar el si pque es nul para que no pase este caso pero realmente este caso en teoría nunca va a pasar porque ustedes pueden suponer Y eso sí lo pueden poner en la tarea ustedes supongan antes de hacer su protocolo eh que p hace escrituras atómicas en su eh en pic no les dice que ustedes pueden suponer que están haciendo escrituras atómicas pero Ustedes sí pueden suponer que e hace escrituras atómicas como está haciendo escritur atómicas realmente es muy difícil que pase este caso sí lo ven entonces básicamente
(34:28) acá lo que lo que estamos haciendo pero si ustedes quieren estar seguros de que en ningún caso porque este caso sí puede pasar si Se está actualizando Ahí está si Se está actualizando el elemento compraran des atómico Sí pero o sea en general bueno sí es atómico entonces pueden suponer que p es todo atómico nada más es o es una demostra muy simple si compran set es atómico demostrar que pique es atómico Entonces supóngase esto de acá si el primer elemento eh si el primer elemento ya está marcado entonces regresa nul si no entonces
(35:33) modifique el ID del primer elemento Y eso es lo que estamos haciendo acá entonces básicamente después nosotros vamos a estar viendo Cuál es nuestro hilo y cuál es el ID del primer hilo que lo modificó porque nosotros tenemos una cola así y nosotros vamos a tener un dos 3 y y así hasta n Entonces cuando ustedes tengan 1 dos 3 y así hasta n lo que van a tener es que van a tener que hacer pic y cuando ustedes hagan pic este -1 se va a cambiar a el ID del hilo que por ejemplo es cinco entonces para este punto la
(36:18) ejecución se va a ver así el hilo a Por qué p tiene que sobreescribir y no solo usa get o eso lo definimos nosotros sobreescribir en En qué parte ah porque acá lo que ustedes hacen es o sea el compr set que ustedes tienen con pic no lo puse pero el comp set que ustedes tienen con P E va por qué lo tienen que sobreescribir el compet que ustedes tienen con pic va a sobreescribir el ID del elemento si ustedes nada más usan get pues lo que les va a regresar va a ser el elemento de o sea este primer elemento y lo pueden definir pero su protocolo de
(37:15) consenso sería bastante más complicado porque si solo les regresa el elemento ustedes pueden empezar a tener problemas porque todos los o sea todos los hilos les van a regresar el mismo primer elemento Entonces cuando ustedes todos los hilos les regresen el mismo primer elemento lo que ustedes tendrían que hacer es meterlo en un o sea meterlo como método auxiliar para ustedes poder determinar eh Esa definición que tú dices de poder o sea para poder determinar Quién fue el primer hilo que lo hizo entonces pic les
(37:50) ahorra este doble paso de usarlo como función auxiliar Porque si p no lo sobreescribi tendrían que usar a p como función auxiliar y y lo tendrían que usar en un método más complicado donde este método tendría que revisar Quién fue el el primero que revisó eh el primero que hizo pic entonces pic de una les está diciendo e o sea p revisa quién Quién fue el primero y por eso lo sobreescribe para que no lo tengan que usar como método auxiliar si no lo sobreescribi tendrían que usar a pic como método auxiliar como
(38:29) lo que vamos a hacer y al final eso sí lo tendrían que definir o sea el método más grande en el que tendrían que entrar eso sí lo tan que definir ustedes pero ahorita no porque px s lo sobreescribe Entonces les ahorra ese paso sí lo o sea lo tienen que hacer acá en este punto de acá nada más para evitar los retrasos pero realmente si o sea es muy raro este caso si no ponen pic O sea si no revisan que pic no es nul en teoría o sea en la teoría en este pseudocódigo este seudocódigo va a estar bien y en la práctica pero en la
(39:17) práctica si no revisan que p no sea nul sí puede tener bastantes fallos bu puede tener fallos en un caso de muchísimos pero sí O sea si lo si lo tienen que poner en esta parte acá que realmente es un caso muy raro y lo que va a hacer pic es que va a sobreescribir el hilo de o sea en esta q va a sobreescribir el men1 por el hilo del primero que lo hizo y cuando lo haga lo que va a hacer es que ustedes van a comparar ustedes van a revisar si pic no es nul porque si pic no es nul Y ustedes están entrando esta parte de
(40:03) acá van a entrar en errores de null Point reception o cosas así con solo usar get sí podemos llegar a un consenso Porque todos pueden tomar el mismo primer valor El problema es que no sabemos si ese primer Exacto Sí entonces por eso tendrían que hacer otro método para poder saber si eh ese primer valor o sea de quién fue propuesto este primer valor me explico Entonces si pic no les diera este este agregado ustedes tendrían que meterle otro método para resolver justo ese problema pero como pic ya les da este extra lo único que tienen que hacer es
(40:51) Llamar a pic revisar su hilo imagínense que el ID o sea que yo estoy revisando como a que sería mi hilo pero el primero que lo hizo fue el hilo cco voy a revisar si yo fui el primero que lo hizo como uno es diferente a c voy a entrar a este caso de acá y voy a regresar que eh el valor que Yo propongo es el valor 5 y todos van a hac lo mismo o sea todos todos todos sin pérdida de generalidad van a hacer esto y eso vamos con la demostración el que tenga el cco va esta parte de acá y va a entrar en un consenso Entonces se va a regresar el
(41:32) mismo y va a regresar el cco Entonces vamos para la demostración tenemos dos casos tenemos dos casos el primero bueno dudas hasta acá de cómo lo hac realmente como p les da todo es bastante fácil nada más tienen que mandar a llamar a pic y nada más tienen que comparar qu hizo p si ustedes son primero que hizo pic o no sí pic es mágico tienen dudas hasta acá un elemento de la que solo tiene el ID del hilo que hizo en q el no el ID que tiene o sea el ID en el que inician todos es en men-1 Entonces cuando alguien hace pic este
(42:34) men1 se cambia por el ID del hilo que hace este que hace pic pero al hacer en que y al hacer de que eso realmente no cambia los ids el único que cambia los ids es p Sí más o menos porque su cola O sea la única modificación que que hacen en su cola es que agregan el método pic q y deq se mantienen igual sí lo ven o o sea si ustedes tienen la cola y ustedes hacen en que entonces un nodo de la cola contiene el ID y el y el
(43:43) propost más bien o sea cada nodo de la cola lo único que contiene ustedes tienen la cola así no se supone que comprar set compar de a my no Exacto Sí muy bien entonces si ustedes tienen la cola así lo que va a hacer es que el enq y el deq se quedan Exactamente igual pero cada elemento encapsula un ID y este ID en principio es men1 Entonces cuando tú haces en vas a hacer en y ar otro elemento pero su ID va a ser -1 entonces e el nodo de la cola solo va a contener el ID cuando tú haces p la primera vez que alguien hace pic
(44:42) este men1 se va a cambiar o sea imagínense que el hilo 10 hace pic si el hilo 10 hace pic como dice Melisa lo que va a hacer es que va a cambiar el ID del primer elemento a 10 y todos los demás se van a quedar en os1 si lo ven entonces Si todos los demás se quedan en menos un lo único que van a O sea la un nodo de la cola va a contener al final de la ejecución el primer elemento va a contener el ID del primero que se movió y todos los demás van a tener os1 Por qué Porque p no se comporta como de q si un nodo ya está
(45:22) marcado si se comportara como deq entonces Si todos los nodos tendrían este un ID diferente Pero al final de la ejecución lo único que van a tener es el ID del primero que se que se movió y todos los demás van a estar inicializados en os1 por cómo funciona pic Sí más o menos más o menos en qué parte no podemos suponer que es global y tiene Sí sí pueden suponer eso igual que p porque si no O sea si no suponen que p es atómico tendrían que hacer esa mini demostración de que porque comprar set
(46:27) es atómico pique es atómico pero supongan que eh propose es atómico y que pique es atómico pero es para consenso de dos hilos o infinito Ah eso vamos La idea es hacerlo con dos hilos y de ahí generalizar lo infinito Entonces si tú tienes o sea imagínate que tienes bueno a ver vamos a hacerlo así imagínense que tienen no hilos infinitos no entonces lo que pasaría imagínante que tiene d e a b c y los que quieras no Entonces lo único que nos importa es saber quién fue el primero el primero p como es atómico lo que van a
(47:18) hacer es que va a tener algo así O sea eh eh el primero que lo haga si es de va a tener algo así va a tener eh que el primer elemento va a ser el primero que se movió y todos los demás van a ser o sea cuando este haga pic lo va a sobreescribir así y cuando todos los demás hagan pic pic va a regresar nul pic no va a hacer nada porque ya alguien lo movió entonces después de que todos hagan pic cada uno de estos nodos va a regresar va a decir si yo soy igual al primero que se movió que es justamente este de acá entonces
(48:07) Eh mi proposed proposed me voy a regresar a mí porque yo fui el que gané de otra forma voy a regresar al primero que se movió que es este de acá entonces para su demostración lo único o sea as más o menos va entonces los demás sí Entonces para su demostración lo único que tienen que hacer y de dónde obtenemos el primero de eh de pic el primero que haga pic va p primero va a obtener el ID del hilo y después
(49:12) eh va a ver que nadie o sea que él es justamente o seaa que él es justamente el primero entonces va a modificar este elemento de acá la cabeza lo va hacer algo así va a modificar la cabeza de del primero a el ID de del que hizo p porque fue el primero entonces para obtener el primero lo único que tienen que hacer es mandar a llamar cuget ID porque dense cuenta que get les va a regresar el primer elemento y el primer elemento o sea tiene encapsulado la ID Entonces esto les va a regresar el ID del primero sí sí más o menos todos entonces para su
(50:21) demostración lo único que tienen que hacer es que tienen dos casos si el hilo actual Ah Es get sobre el resultado del P en no aquí es get sobre la cola si aquí es o sea get lo que les va a dar es o sea el valor de de la cola por lo que bueno esta parte en uno de los protocolos de consenso que vieron a la maestra eh qg ID lo que les va a regresar es el id registrado en el primer elemento Entonces si tien la cola en los protocolos de consenso que ya vean con la maestra cuget ID lo que les va a regresar Es que les va a
(51:13) regresar la n que est en el primer elemento entonces lo que hace esta parte de acá es que regrese el ID registrado en el primer elemento de la cola alguna pista rápida para el ejercicio dos Eh bueno a ver nada más para acabar nada más para su demostración tienen que hacer estos dos casos tienen que verificar o sea esta parte de acá la hacen formalmente si el caso en el que ustedes fueron el primero va a ser correcto el caso el que ustedes no fueron el primero también va a ser correcto Y entonces de ahí eh cuando ustedes argumenten eso ya pueden
(52:00) concluir que el consenso funciona correctamente para un número infinito de hilos y para el ejercicio dos lo que tienen que hacer eh está por acá Ajá una pila tiene dos métodos lo que tienen que hacer es que primero tienen que considerar Eh bueno primero tienen que probar que stack tiene un número de consenso de al menos dos y luego tienen que ver que es exactamente de dos pero lo primero primero que tienen que hacer es que es de al menos dos y tienen su van a poner su stack lo vamos la siguiente clase pero van a poner toda su
(52:37) stack e van a argumentar Por qué funciona para dos hilos van a hacer su ejecución para dos hilos demuestran esta parte tienen que usar el lema 5.1.3 me lo aprendí para ese ejercicio de El libro del libro principal tienen que usar es para argumentar que nada más es o sea para 5.1.3 eh tienen que argumentar que funciona para argumentan que funciona para dos hilos luego suponen que existe para tres hilos usan este lema 5.1.
(53:21) 3 llegan a un estado crítico no se puede entonces es de exactamente dos eso es básicamente como cómo funciona esa última demostración pero lo vamos a ver con más detalle el jueves el jueves vemos todo este ejercicio va entonces nos vamos el jueves y revisamos este ejercicio y me avisan si tienen cualquier duda Va
