(61) Clase 6 2024 08 14 - YouTube
https://www.youtube.com/watch?v=gQlBX1DbEAo

Transcript:
(00:05) vimos el protocolo de alib Y en este protocolo pues parecía como mu y muy este muy favorecedor con al se acuerdan no del gatito y el perrito Entonces al final la moral eja era que pues bueno podíamos resolver este problema de forma pues medio este medio injusta no para Bob pero pues se podía resolver este utilizando dos variables de un solo bit e y pues cada Alice tenía una variable no y una ellos podían escribir en su propia variable y los el otro podía leerlo Entonces no sabíamos quedado en eso y además habíamos formalizado eh
(01:00) la la definición ya de exclusión mutua no de forma así más rigurosa entonces yo les había definido Esta esta este concepto de sección crítica en donde yo les había comentado que pues simplemente es un bloque de código que solo se ejecuta por un proceso a la vez y les había comentado que íbamos a usar esta anotación de critical section no entonces e Ah también les había comentado las reglas para las propiedades que íbamos a ver que pues era que eh solamente hay una sección crítica por por este por candado y que pues el método lock
(01:49) siempre va a adquirir o sea va a entrar esa sección crítica y el método unlock va a dejar el cado es decir va a salir de esa sección crítica Vale suriel dice acabo de entrar estamos viendo un repaso nada más vale un repaso de lo que vimos la clase pasada entonces eh habíamos visto esta sección crítica yo les había comentado que pues la idea del exclusión mutua es que las secciones críticas siempre tengan un orden de precedencia es decir siempre exista esta flechita Vale entonces aquí se ve un ejemplo en donde se cumple esa
(02:27) precedencia porque la sección crítica es este se toma digamos que en el intervalo en color rojo Entonces estos intervalos tienen una relación de precedencia vale porque pues no se traslapan en el tiempo y además les había comentado que la sección crítica este bueno esta anotación Va de que es la sección crítica que tome el hilo a y es la jma vez que ejecuta ese código Okay o podríamos decir como es la es este el hilo el este Alice o sea el gato de Alice no ha tomado el el patio jma veces Vale entonces como que es la idea
(03:11) no eh Por eso es jé veces no j+ unim veces y así va aumentando porque en realidad el gato pues puede salir al patio varias veces no Y también el perro o sea puede tomar la la sección crítica Claro que pues para el perro en este caso pues no era muy favorecedor no Okay entonces Este era el concepto de exclusión mutua No ya visto hablando como rigurosamente entonces secciones críticas que tienen un orden de precedencia Así le decimos luego eh También habíamos comentado de forma Bueno al final de la clase anterior eh
(03:51) que la propiedad de deadlock free o sea de libre de candado muerto coins sía en que alguien va a tomar el candado okay e Entonces esto lo que implica es que como aquí les había puesto un ejempl ito no que puede ser que que un hilo por ejemplo el hilo a en este caso pues trate de adquirir el candado y nunca lo logre es la es puede ser no pero si el hilo B este siempre tiene éxito no O sea si alguien tiene éxito o el hilo c o el hilo d o sea cualquiera de los hilos no que exista en un sistema con eso decimos que el candado no está muerto y que
(04:31) tenemos un deadlock freeo o sea tenemos libre de candado muerto Okay entonces esto este concepto si se dan cuenta pues lo que implica Es que este sistema nunca se congela O sea que alguien tenga éxito Porque si nadie tiene éxito es un problema no O sea realmente el sistema se congeló pero si alguien tiene éxito decimos Ah mira Bueno o sea no está no es el protocolo no es muy justo Pero sigue funcionando Vale entonces eh Por eso yo aquí Les comento no eh si Lilo a ejecuta el método log O sea que trate de adquirir el candado pero nunca lo
(05:08) adquiere bueno no pasa nada no Simplemente no lo adquiere pero no detiene a los demás okay Porque podría ser un protocolo chafa no que un hilo se bloquee y bloquea a los demás pero en este caso como B puede adquirir la sección crítica una vez luego dos veces no tres veces o sea c más dos veces no le pasa nada entonces los demás hilos pueden obtener el candado un número infinito de veces no pueden entrar a la sección crítica un número infinito de veces por eso se describe de esta forma y aquí yo les había puesto un ejemplo de
(05:43) Pues que podría ser de hecho nuestro protocolo nosotros dijimos Bueno este desde la clase anterior ustedes me habían respondido que que consideraban que el protocolo si era deadlock fre porque Alice siempre podía entrar Aunque Bob no no entonces aquí yo les había puest puo un ejempl ito en donde sí puede ser que Bob siempre trate de poner su bandera en verdadero pero Alice también la la levante no enseguida y Bob Pues siempre la baje entonces podría ser que Bob pues nunca acceda al patio no O sea nunca tenga tiempo en el patio y el
(06:19) patio en este caso sería nuestra sección crítica Okay entonces esto era deadlock free luego nos quedamos en Star free era que que starvation es más más duro o sea nos dice todos los hilos eh que traten de adquirir el candado en algún momento por eso eso este eventualmente tenga éxito e entonces bueno Esto es bueno puse esta esta cajita porque en realidad si se dan cuenta este eventualmente como que es muy impreciso no como que dices Bueno eventualmente este en el infinito más un o qué no como que te quedas pensando no
(07:02) como como matemáticamente esto Cuándo es no cuándo pasa entonces e Sí pues realmente no no es muy realista vamos a ver que existen propiedades más duras No por ejemplo si formamos a los hilos eh que quieran tomar el candado y decimos que si si B llegó después de a la fila pues va a pasar después de a no como que eso sería algo más más este este con menos incertidumbre y más duro no as si a fuerzas va a pasar cuándo pues después de a no B va a pasar después de a entonces Bueno en realidad si se dan cuenta les digo es como que bueno podría
(07:42) esperar mucho y sería estar Pues sí pero pues ya Cuánto tardó en llegar no Bueno pero eventualmente lo hace como que es es el entonces e si se cumple esta propiedad si decimos que todos los hilos pueden entrar o sea adquirir el cado eventualmente pues quiere decir que se cumple la anterior no que es deadlock free porque alguno o sea como que todos pues incluye alguno No si decimos que se cumple est visón entonces también se cumple deadlock free Okay entonces son esas dos propiedades más este como que nos gusta
(08:34) que se cumplan en candados porque como ya vieron el que se cumpla exclusión mutua es como muy trivial no O sea como que hay que garantizar Además de que solamente uno puede entrar a la sección crítica hay que garantizar Cómo van a entrar o sea Cuándo no como estamos en concurrente nos importa mucho el tiempo o sea estamos muy muy muy este siempre muy al pendiente del tiempo Vale entonces entonces eh en el mundo secuencial e cuando ven su clase de algoritmos de análisis de algoritmos en realidad pues siempre están
(09:12) como presentando una invariante o sea por ejemplo el profe les dice no pues este este es el algoritmo encuentren una invariante Por ejemplo si es un protocolo es un algoritmo de de este vida y vencerás no eso es regularmente si tienden a tener ciclos o recursión no en donde se hace lo mismo en cada paso y en cada paso te vas acercando cada vez más al resultado no entonces el profe te dice encuentro una invariante que se cumpla en cada ciclo for no o en cada recursión no depende Si es iterativo o recursivo y este entonces uno tiene que
(09:51) decir Ah bueno este bueno en este punto siempre se agrega eh Por ejemplo un algoritmo de ordenam en este punto siempre se agrega un un este un número en orden no O sea siempre el número que venga siempre va a ser mayor que los que ya están por ejemplo no esa son propiedades de seguridad como que te consta y puedes asegurar que siempre va a pasar esto Okay entonces Esas estas eh propiedades les vamos a llamar de seguridad por ejemplo una propiedad e de seguridad sería la propiedad de la exclusión mutua Por qué
(10:30) Porque nos dice yo te aseguro que las secciones críticas de dos procesos nunca se traslapan no las propiedades seguras siempre te dicen eh Bueno es como que esta lógica de nada malo pasará nunca no O sea y eso asegura que pues siempre va a pasar lo mismo no O sea pero como que es más fácil asegurar lo que no va a pasar que lo que siempre no entonces este se se refiere a esto la exclusión mutua eh y es una propiedad de seguridad se dos secciones cras críticas nunca se trasladan vale entonces podríamos decir asegurar a partir de de la exclusión
(11:10) mutua decir pues el perro y el gato no estarán nunca al mismo tiempo en el patio no y ya con eso decimos Ah pues resolvemos el problema no tienen al y bueno Estas son las nuevas para este curso o sea bueno ustedes ya conocen las de seguridad de seguro han no sé cuando han visto les digo algorit de ordenamiento algoritmos en gráficas o sea siempre hay como de No pues el por ejemplo el short SP no el algoritmo para encontrar el camino más corto Ah pues siempre en cada paso Pues estamos seguros de que añadimos al siguiente más
(11:43) corto no O sea al al que llegamos en menos Pasos Por ejemplo Pero estos de viveza de así les dicen tien que ver más con las cosas que suceden en el tiempo y Aquí les pongo suelen estar muy presentes en el análisis de algoritmos concurrentes porque nos importa mucho cómo se traslapan las operaciones Okay entonces eh estas propiedades nos afirman que algo bueno pasará si se dan cuenta las otras es así como de nada malo nunca pasa No o sea es como el tiempo presente es una seguridad todo el tiempo no en el tiempo presente y estas nos dicen en el
(12:23) futuro Espero no que algo bueno pase pasará no eh entonces dos propiedades y Bueno las dos que vimos ahorita que son deadlock free y starvation free ambas si se dan cuenta tienen que ver con el tiempo la propiedad de loock free nos afirma que algún hilo en algún momento se eventualmente logrará adquirir el cangado entonces eh En este caso podríamos asegurar el gato siempre que quiera podrá salir al patio no Bueno pero el perro no O sea no podríamos asegurar que el perro siempre que quiera podrá salir al patio
(13:03) eventualmente no pero el gato sí siempre eventualmente él podrá salir al patio Aunque si se dan cuenta no es como que o sea como que hablamos de de tiempo no cuándo pues eventualmente pero no con seguridad no porque también Contamos con que el gato siempre va a bajar la bandera Okay como que dependemos un poco del otro por eso se es eventualmente Okay entonces por ejemplo Aquí les tengo un Quiz e este bueno viemos estas propiedades de seguridad y de viveza no entonces Eh me tienen que decir Ustedes esos siguientes
(13:43) enunciados ustedes qué creen como que representa e por ejemplo este primero dice lo que sube debería Bajar este que Qué sería o sea es una una de seguridad o de viveza dicen bueno Camilo es el que le atinó es una bueno se contestó bien Es de viveza Ajá sí sí por qué Porque no es una de este no es un lo que sube eh nunca se debería quedar arriba no O sea nunca debe quedarse arriba Es como eso sería para que fuera de seguridad pero como lo decí de Bueno lo que sube debería bajar cuá Pues no sé no Pero porque eso no siempre es
(14:36) bueno Ajá es de viveza porque es el tiempo en el que se habla No no te estoy asegurando cuándo no Simplemente te digo como debería debe Pues no sé no pero debería o Entonces por ejemplo aquí nos dicen las deza algo bueno pasará no pues lo bueno que debería pasar es que baje no pero nos aseguran que algo nunca malo pase o bueno que algo nunca pase entonces bueno si más o menos como que les Bueno ahorita vamos a ver que que me respond las siguientes este esta otra opción ocurre un mensaje Se imprime en un segundo esta de Qué sería Ajá
(15:35) seguridad no Sí o sea es como de hecho hasta una conexión lógica no sí entonces una implicación Ajá sí como que podríamos decir este nunca pasa que no se imprima un mensaje un mensaje después de un segundo no O se hasta nos dicen cuándo podríamos decir no que es de seguridad porque luego esta otra si dos o más hos están tratando de entrar a una sección crítica entonces eventualmente alguno tendrá éxito de viveza no aá como que lo que nos guía un montón es que es eventualmente estoy escribiendo de viveza y lo bueno que va a pasar es
(16:38) que lo bueno es que alguien tenga tendrá éxito No de hecho este verbo así tendrá en algún momento no sé cuándo No no es una seguridad así riguroso este como me digan Ay este siempre tendrán éxito después de 10 segundos no Ah bueno eso está bien Pero esto es como u en algún momento Entonces Ah bueno Y esta última el costo de la vida nunca decrece no no sé seguridad sí es como chistoso No porque como que no nos gusta que nunca decrezca pero nos aseguran que pues siempre la inflación va a subir siempre este todo va a estar
(17:18) más caro no Entonces es una seguridad eh No es como que eventualmente no es que algo siempre va a pasar no Entonces se dan cuenta como que la diferencia entre seguridad estas cosas que siempre hemos visto en algoritmos no como que no hay de otra y aquí es eh Como tenemos esta esta puedes repetir Entonces cuál es la diferencia entre las dos aj Sí ajá sí la seguridad este les digo como ya ya lo hemos visto en realidad en algoritmos o sea ustedes les pongo un algoritmo secuencial y les digo a ver este demuéstrenlo es correcto este algoritmo
(18:00) secuencial y qué hacen Pues dicen Ah Déjenme Déjenme reviso qué se cumple siempre en cada paso del algoritmo no Entonces como ya escucharon no que se cumple siempre no algo que nunca pase este ahora sí que es lo contrario no a que se cumple siempre o sea como podemos asegurar algo pero en las de viveza como tenemos el factor del tiempo Eh pues esperamos por ejemplo en deadlock free que pues el sistema no se nos congele Eh entonces esperas que alguien siempre tenga éxito Sí pues en viveza puede ser que no suceda es que en viveza en
(18:41) realidad no es que no suceda sino que no sabes cuándo va a suceder es eso porque por ejemplo si el si yo diseño un protocolo y les digo este protocolo es deadlock free o sea quiere decir que nunca se congela realmente no se va a congelar no O sea eh pero el que el que este algún lo va a tener éxito este pues sí pero no sabemos quién y no sabemos cuándo no Ajá sí en vivez sí es la diferencia como dice Sebastián ajá si es como que cuándo O sea yo les digo este Se me congela nunca Sí pero cuento con que los hilos la sección crítica
(19:23) Para que otro pueda tener éxito no O sea Cuándo no sé eh pero se va a cumplir vale es como como una seguridad chafa en el tiempo no este la viveza cuándo Pues no sé pero le te prometo que o sea como ustedes no este van a trabajar y les dicen Oiga este eh Cómo enseñaste este este algoritmo no pues te juro que es deadlock free O sea que no se congela y de repente un hro se tarda mucho en una sección crítica y te están viendo así como de Oye pero cómo no se congela no Sí o sea si el hilo a deja esta sección crítica el otro hilo va a poder tener
(19:59) éxito no cuándo Pues no sé pero no se congela Ajá Y al final ambas se relacionan con la computación concurrente porque pues como vimos la computación concurrente en realidad es el análisis del entrelazado de la computación secuencial no O sea siempre tenemos algoritmos secuenciales sí no tenemos eh propiedades de seguridad en estos algoritmos Sí porque en cada ciclo pues se va cumpliendo algo no Aunque este También tenemos est otro factor que como ahora tenemos un montón de hilos haciendo cosas a la vez pues tenemos
(20:33) este factor del tiempo no O sea que contamos con que el progreso de este este o sea que este progrese para que yo progrese no Ajá sí en computación concurrent los procesos se comunican Este pero se comunican en y en la par los procesos no se comunican Pues sí digamos que en ambas se comunican pero en concurrente con como que este o sea considera que que paralela es una sub no de concurrente Entonces en realidad Pues sí se comunican pero tal vez hasta el final ya cuando tienen los resultados no pero mientras Pues tú hiciste lo posible para
(21:12) darles a cada quien su trabajo No desde antes como vea pues resuelve este pequeño problema O sea no es como que se comuniquen para dividirlo es que tú ya se los has dividido lo hacen y ya hasta el final de alguna forma tal vez se comunican al final para unirlo no este o al contrario tú ya lo unes no Ajá pero en concurrente Sí o sea nos nos nos preocupa estamos justamente este en el análisis de cómo se traslapan los las operaciones Okay entonces bueno existen ya implementaciones de candados no H este en Java y de hecho estas
(21:50) implementaciones pues corresponden a increíbles implementaciones que se han publicado en artículos O sea ya hay mucho trabajo no y están probados Están demostrados y que al final pues terminan este como métodos ya este bueno como objetos no librerías ya en Java y bueno y en otras claro no O sea nosotros Porque estamos viendo Java entonces eh De hecho la interfaz eloc este te provee Bueno puses nada más est aquí pone nada más estos dos métodos pero en realidad pues la interfaz de loog hasta tiene más No pero bueno los
(22:27) básicos pues es Tom al candado y de déjalo es lo que necesitamos para utilizarla este Pero bueno nosotros como estamos estudiando esto detalle Pues nos interesa no solamente como ya lo que nos tiene preparado Java o cualquier otro lenguaje sino como de Bueno ahorita vimos un protocolo más o menos que resuelve el problema no que es como un candado pero está medio chafa no Entonces vamos a ver otros más Este y de hecho el protocolo que vimos pues nada más funciona para dos hilos no O sea para Alice y para Bob Entonces vamos a
(23:00) ver este algoritmos de candados primero vamos a ver para dos hilos porque pues son los más fáciles y para que vayamos viendo analizando cómo son estas dos este bueno estas tres no exclus mutua deadlock free y estv free estas tres propiedades okay Y para dos hilos y luego para para n hilos Entonces vamos a ver ahorita para dos hilos eh ese es un protocolo este un algoritmo de candado un algoritmo concurrente no pero solamente para dos hilos Vale entonces este está en libros Aquí les pongo las figuritas Y si quieren pueden revisar el libro y
(23:44) leerlos no pero bueno aquí los vamos a a ver e entonces este candado el one Pues implementa un objeto esta de esta esta Bueno este arreglo no pero son dos variables vamos a considerarlo así tenemos al hilo Bueno vamos a poner el hilo a y el hilo B Vale entonces tenemos dos variables compartidas y cada hilo va a tener su propia este bandera Vale entonces vamos a pensar que la variable compartida una es la del hilo a y la otra es la del hilo B Vale entonces este este algoritmo concurrente tiene este dos métodos el método de log
(24:44) o sea tomar el candado y el don Entonces cómo toman el candado pues primero en la línea c este digamos que el hilo a vamos a pensarlo así no tiene su ID vale solo esto es para que pueda referirse a su bandera o a la del otro okay nada más como que así y pensemos no que pues él recibe la el ID este cero y este recibe el ID uno no así entonces vamos a pensar No sé que a tiene el ID cero y b tiene el ID uno no en esta implementación entonces este en la línea cinco pues les digo no dice Ah mira yo soy cero y b es
(25:37) uno entonces voy a poner Mi Bandera en verdadero inicialmente ambas banderas Pues consideremos no que estaban en falso entonces eh Y así digamos que en esta línea pues ya es como que yo digo Ah pues yo quiero pasar no yo pongo Mi Bandera en verdadero y entonces el línea 8o este reviso si la bandera del hilo B está en en verdadero si está en verdadero entonces me voy a quedar dando vueltas en este ciclo Okay voy a escribirlo aquí si voy a ponerlo con flat de B es verdadero entonces eh Me quedo en el ciclo okay Y si me quedo en el ciclo
(26:37) quiere decir que pues estoy como esperando dando vueltas ahí en ese ciclo While Esperando que en algún momento la bandera de de B pues sea falso si es falso Entonces algo del ciclo Y entonces quiere decir que termino de ejecutar el método lock y ya como vimos nosotros yo les había comentado que cada vez que emos el método Loc de forma exitosa es quiere decir que pasamos a la sección crítica vale Entonces digamos que la idea este de los hilos que que tienen ambos es que puedan terminar de ejecutar lo Okay entonces este imagínense no que que pues
(27:16) a realmente puede pasar no porque la bandera de B pues está en falso entonces obtiene la sección crítica y ya para dejar el candado lo que hace es que bueno primero También toma su bandera Y entonces simplemente pon su bandera en falso Vale entonces si el otro quería pasar este djen ver aquí qué ejemplos tengo Okay entonces voy a ponerles aquí el hilo a el hilo B no Entonces yo les había dicho que y de c y de un no y este están ejecutando loog Loc no entonces quiere decir que que en este punto vamos a ponerlo en
(28:12) este punto imagínense que aquí entonces aquí en este punto este flag de a es igual a true entonces imagínense que y esta por ejemplo sería pues la sección crítica no algo así Dentro de gu entonces la sección crítica no no no no este una vez que el hilo a acaba de ejecutar el lock o sea digamos que para que pueda entrar en la sección crítica este por ejemplo vamos a pensar que este es lock no ejecuto lo as luego aquí no s es value más más y y luego hago unlock entonces esta de aquí el value
(29:16) sería la sección crítica todo lo que está dentro de log pues simplemente es lo que corresponde al método loog okay O sea Eh entonces La idea es que el hilo el hilo aquí de terminar de ejecutar lock para poder ejecutar Pues el código que está en la sección crítica o el código ahora sí que el peligroso Ajá Exacto sí lo que está dentro entre lock y unlock es la sección crítica Exacto sí e entonces este nada más es un algoritmo de candado o sea digamos que este algoritmo nos va a funcionar para después hacer nada más esto O sea para
(29:54) tomar el método log y luego ahora sí escribir nuestra sección crítica o sea como el código que queremos proteger y ahora sí dejar el unlock vale o sea como que nos estamos metiendo como a fondo no este estamos viendo que hay dentro del Loc Entonces desde la línea 5co y la oo Ajá digamos que la línea 5 a o es lo que está dentro del lo no o sea es lo que tenemos que hacer para poder tomar el candado entonces Bueno vamos a pensar que este es el aquí pongo la bandera la bandera de a en este punto tiene que estar en
(30:37) verdadero para que este porque pues esto lo hace la línea s y supongamos que el hilo B pues este está inicializada nada más su bandera en falso no entonces imagínense que aquí el hilo B llega no y este y él pone su bandera de en verdadero no en la línea siete y luego en la línea este y así sigue no en la línea ocho él revisa dice a a ver la bandera de a cómo está y como a está en la sección crítica quiere decir que está en verdadero entonces él se va a quedar esperando en la sección crítica Okay Sí claro o sea como dice Sebastián si a uno
(31:29) se le olvida poner el unlog pues ya valió no porque esto quiere decir que que B Se va a quedar ahí no hasta que a decida hacer unlock entonces cuando haga un loock a lo que va a hacer es que va a hacer que su bandera de a sea falsa Y entonces B por fin va va a poder este eh terminar este Método en lock y entrar a la sección crítica okay Y así como que más o menos este más o menos cachan có Cómo va esta ejecución y y que en realidad pues la sección crítica pues como que digamos que ahorita no la estamos viendo no O
(32:15) sea la idea es que ejecutemos lock y luego este ejecutemos unlock de esta forma y metamos Pues no sé lo que queramos meter en la sección crítica va Sí y después B tendría que usar un lck para que a o b vuelvan a entrar Exacto Sí sí O sea la idea es que tomas el candado y lo dejas y lo que está entre la toma y y y el dejar el candado esa es como nuestra área restringida que es exclusiva nuestro Bueno o sea como que el código que podemos ejecutar nosotros exclusivamente no y que lo tenemos ahí protegido Okay entonces
(32:58) este este protocolo analizando no estas propiedades que vimos las tres satisface la exclusión mutua Eh pues para demostrar esto hay que suponer como Nosotros sabemos no esta propiedad de exclusión mutua pues es una propiedad de seguridad no es decir que nunca se tiene que cumplir esto no esto Qué es se acuerdan yo les había comentado que que este esta flechita de aquí es la que nos dice que la sección crítica de a precede a la sección crítica de B okay Entonces digamos que aquí lo que nos dicen es que suponer por
(33:40) contradicción que este eh vamos a suponer por contradicción que no se cumple una precedencia de cs a csb y de csb a csa es decir que eh las secciones críticas Bueno voy a poner las críticas sections se traslapan O sea suponer que se traslapan vale entonces simplemente lo que estamos diciendo es que hay que suponer que existe una sección crítica de a y de B voy a ponerlo así cs de a y cs ay c C de B que se traslapan en el tiempo no así vamos a argumentar
(34:43) Esto entonces hay que suponer por contradicción que existe una sección crítica de a y de B que se traslapan qué Qué necesitamos que pase para que ocurra una sección crítica de a o sea para que se termine de ejecutar el método para que a termine de ejecutar el método loog no tendría que pasar que que la flag de a sea verdadero y además tendría que pasar que la flag de B sea falso y además se tiene que cumplir este una Ajá que tenga el C se fake entonces tiene que cumplir que primero esté en en verdadera la bandera
(35:38) de a y que después por eso pongo esta línea de precedencia después la bandera de B está en falso okay Y para para que ve tomar el candado o sea para que ve terminara de ejecutar el método pues ocupa que sea falsa su bandera o sea verdadera su bandera y que justo después él revise la bandera de a este y esta sea falsa no cosa que pues no es posible que pase no porque este si si si el hilo a ya está en la sección crítica quiere decir quiere decir que este que no puede ser que la bandera de se no O sea para que también estuviera en
(36:31) la sección crítica okay Entonces digamos que pues aquí pues es una contradicción entonces así como que como que esto está como fácil de ver no este suponer que existe un traslap y luego ver cómo sucede la lógica de las operaciones primero Ah escribe en su bandera revisa la deb y esto justo tiene que coincidir con que la bandera de B sea verdadero y que al revisar la de sea falso lo cual es una contradicción no Entonces es así O sea Claro que se cumple el protocolo satisface exclusión mutua no o sea es no sirve como
(37:13) candado luego este este este otro eh esta otra propiedad bueno es que lo One no satisface de loock free okay Y por qué no está como muy chafa el protocolo no estado bonito al inicio pero como que como que no nos garantiza muchas cosas no Entonces qué pasa aquí pues miren si resulta que ambos Ejecutan lock Pues más o menos así este Bueno en realidad no acaban entonces aquí ambos Ejecutan look y en la línea s aquí hace no s a escribe su bandera de a en true y aquí supongamos no que que B
(38:23) escribe su bandera en entonces en la línea ocho este para para que puedan terminar Ya de ejecutar este candado este en la línea ocho supongamos que aquí hace a este lee la bandera de b y aquí no sé lee la bandera de a y yo sorpresa no ambas están en verdadero y entonces quiere decir que ambos hilos se van a quedar en este en línea ocho atrapados porque resulta que el otro también quiere pasar H Y entonces quiere decir que existe una ejecución en la cual eh el candado se queda con
(39:29) congelado Okay eso pasa un abrazo de la muerte sí o se el candado muerto no y este Por qué Pues porque nadie lo adquiere No pues Y eso qué quiere decir que nadie acaba de ejecutar lo o sea pequeño detalle no y se quedan dando vueltas y quién nos va a sacar Pues nadie no O sea ni tú avanzas ni yo porque nadie va a querer poner su bandera en falso ambos están dando vueltas en el oo no en la línea o Okay entonces no se cumple de lo free por esta razón entonces este ustedes consideran que se satisface starvation free dado
(40:23) esto no no aj porque pues la otra es una ición o sea como que todavía si no se cumple deadlock free pues pues no se cumple starvation deadlock free nos dice como que nos dice alguien va a adquirir el candado y estar nos dice todo el que quiera adquirirlo lo tendrá éxito entonces este es una generalización no O sea si no se cumple que alguien lo adquiera pues menos que todos vale Sí entonces este no se satisface pues simplemente porque deadlock free no satisfase no Simplemente Okay entonces e Bueno Este es otro candado muy bonito
(41:18) este este es el lock to el otro er One este entonces e en este candado Lo que sucede es que existen vamos a considerar no También tenemos a los hilos a y b Okay Entonces ahora tenemos simplemente una variable compartida que se llama ptim variable compartida esta se llama victim y es una en un entero no entonces el hilo a por ejemplo va a decir Pues voy a tomar mi d y yo me voy a poner de víctima entonces este modifica esta variable compartida entonces quiere decir que B también va a poder leer lo que a escriba no y viceversa entonces en
(42:12) la línea se algú algoritmo que s cpra fre pero no cpra estation no no Ah sí sí si existen por ejemplo el de Bob el que vimos era free pero no era este protocolo Este sí sí hay e este de hecho me acuerdo No tampoco Sí sí ahorita nada más el que vimos pues es el de alib pero no me acuerdo si vemos otro Así sí porque como que nos gusta que sean también starvation free pero bueno a ver este entonces es se escribe como víctima perdón a noo a se escribe como víctima entonces en la línea seis si Alice va a checar si yo soy la
(43:09) víctima Entonces me quedo esperando Okay entonces por ejemplo qué podría pasar un ejemplo de una ejecución tenemos as sí Alice y bueno Perdón al hilo a y al hilo B pues cas hilo a y hilo B entonces este el hilo a por ejemplo Pues empieza a ejecutar lo y aquí en la línea este cinco e dice pues la víctima soy yo y y en la línea seis este pues va a decir línea se pues va a estar ahí dando vueltas no dice ah soy el yo soy la víctima yo soy la víctima y pues se va a quedar ahí dando vueltas no todo hasta que no llegue el hilo B a ejecutar look y se
(44:07) escriba como víctima víctim B entonces este este Lila va a decir Ah mira ya no soy la víctima entonces termino de ejecutar y este sección hago mi sección crítica no y ya pues después hago unlock Pero pues si se dan cuenta este unlock Bueno aquí no sé por qué no está pero pues la idea es que este después no cuando este vuelva a ejecutar el lock otra vez va a ser la víctima Y entonces ve que se quedó aquí va a poder terminar no Okay entonces aquí va a ejecutar la
(45:12) sección crítica y así en qué momento la declaración para que deje de ser la víctima Pues si se dan cuenta cuando este el el hilo B Porque si estos este c este solamente es para dos hilos entonces partida a sí Exacto como dice sebasti en el one había pues dos variables pero ambas el hilo a solo escribía Pues en su bandera no y el hilo B escribí en su bandera pero ambas leían la del otro y en este caso tenemos una sola variable que puede ser escrita por ambos Okay pero ambas son o sea son compartidas Entonces si el hilo este B
(46:05) se escribe como víctima Entonces el hilo a que está leyendo esta variable compartida dice Ah mira ya no soy yo ahora es b y ahora este ya puedo ejecutar mi sección crítica y terminar del candado no y así entonces luego lo B este no va a poder llegar o sea su sección crítica terminar o sea ejecutar el lo hasta que vuelve a ponerse como víctima es decir hasta que Lilo a vuelve a ejecutar un lo Okay este entonces pues si se dan cuenta como que ya hay un problemilla no hay un problemilla este como que con el tiempo no está
(46:56) extraño Pues yo tenga que esperar hasta que el otro quiera para que yo pueda pasar y a su vez este el otro debe querer otra vez no para que yo pueda pasar y así como que parece como relevos no O sea como Dame la mano y Ajá como que se ve claramente que no satisface estar Vision free no O sea que todos no pueden tener éxito es claro no como que ya vamos cachando no estas propiedades más más este como de vista no dices Ay no esto no no lo cumple Pero bueno s cumple exclusión mutua porque pues este como vimos no eh supongamos Por
(47:36) contradicción que que las secciones críticas se traslapan no es esto y Y entonces tengo tiempo este para que a este logre entrar en su sección crítica pues la víctima debe ser B no Y para que B pase la sección crítica la víctima debe ser a entonces claramente pues esto es una contradicción no no puede ser que amb o sea bueno que que igual a se satisface en realidad que no se el que va a pasar y
(48:40) vi entonces dice seb este pues miren por ejemplo podrí pasar no de cumple Dead lock free en este caso en el anterior se acuerdan en lo One si ambos trataban de hacer cosas concurrentes el candado se bloqueaba Y en este caso si solamente hay uno que quiere hacer algo pues nunca lo va a obtener porque por ejemplo Lilo a este dice Ah pues yo quiero ejecutar Loc y y se como víctima y el hilo B si no hace nada pues pues no lo va a obtener no O sea ahí tenemos un candado muerto no un candado muerto Entonces se dan cuenta el otro estaba
(49:38) chafa cuando teníamos concurrencia o sea cuando dos hilos hacían loca al mismo tiempo y en est está chafa Cuando no tenemos concurrencia no o si no llega al hilo B pues nunca lo va a lograr no Okay entonces por lo tanto si o sea como ya lo este ya lo habían visto pues no se cumple starvation free Pero bueno no todo está malo Este la unión de de l One con lo2 nos da el candado peterson que fue una solución muy bonita por los años 70s creo u ya bien viejito este cnd este Pero bueno satisface este problema para dos hilos y este cndo si está o sea
(50:21) está mejor vamos a ver no de de qué va Entonces me igual es para dos hilos entonces voy a voy a seleccionar los hilos a y b no entonces variables compartidas son estas dos líneas nuestras variables compartidas ahora tenemos bandera y tenemos esta variable de victim Okay es como que ya ver lo unimos entonces este Pues digamos que tenemos la bandera de a y en falso tenemos la bandera de B en falso y vamos a pensar que la víctima es como que no tiene No tiene nombre no este pues no sé cero no porque es un entero entonces e se ejecuta el
(51:30) candado y lo primero que hace pues el hilo a es ver su ID para poder referirse a su bandera o sea para poder escribir nada más en su bandera no entonces en la línea oo escribe en su bandera se escribe como verdadero en la línea nu se escribe como víctima entonces en la línea 10 lo que va a hacer es que va a decir este se va a quedar esperando solamente si va esperar Bueno voy a ponerlo así se quedará en el ciclo Si e e b Quiere pasar y a es la víctima Okay entonces bueno así Más bien voy a ponerlo así a se quedará no
(52:31) Entonces a se queda en este ciclo si B Quiere pasar y ya es la víctima okay Y así mismo también b b se va a quedar en el ciclo si ya si ya quiere pasar y ve es la víctima ahora okay Entonces viceversa eh Y simplemente para dejar el candado lo que van a hacer es que van a poner su propia bandera en falso Okay Entonces ahora sí este Bueno vamos a vamos a ello eh igual no eh lo primerito es es demostrar ser víctima que era Ajá ser víctima simplemente es escribir tu ID o sea como que tú te este como que este este protocolo es así como
(53:22) de como de amable no gente amable o sea yo quiero pasar pero yo me pongo como víctima no O sea como que y Y si el otro Quiere pasar pues el el último que se haya puesto como víctima pues es el que se va a quedar no ajá si ser víctima es cuando esperas Sí o sea como que por ejemplo aquí no le dicen ay levanto Mi bandera estoy interesado o pero tuve primero no como que es así Eso este y te pones como víctima entonces por eso acá Este si tú eres la víctima y el otro también quiere pasar pues que pase él no porque
(54:01) pues eres muy lindo O sea que pase él entonces pero por ejemplo como ya se cumplen ahora tenemos este Bueno vamos a ver ahorita no eh vamos a vamos por pasos Okay primero exclusión mutua eh Ah bueno ya ni me va a dar tiempo pero bueno exclusión mutua primero e este pues simplemente Cómo demostramos esto Pues suponemos igual no por contradicción em que las secciones críticas se traslapan suponer eso no entonces para que suceda una sección crítica de A qué ocupo que pase e este ocupo que primero poner Mi bandera de a en verdadero
(54:58) y después poner victim de este igual a a no es lo que ocupo y además después ocupo revisar que bueno ocupo leer que la flag de B está falso o ocupo que la flag debe est verdadero y que este que vitim sea B no Para pasar Se quiera pasar pero que sea la víctima para que yo pueda pasar o sea para que suceda esta tiene ahora sí que y para que suceda la sección crítica de B pues simplemente tendría que pasar que
(56:04) que flag de B está en true este y en este caso que bueno voy a ponerlo así sí que victim se escribe como víctima Y entonces ya al final ocupa leer que la flag de a está en true no este y en este caso por ejemplo pues se cumple no O sea para que ya pase Pues sí tiene sentido eh Pero además para se ocupa que la flag deas sea true eh pero que no sea la víctima el mismo no entonces aquí es donde ya se cumple la contradicción porque victim solo puede ser o a o b no entonces Depende para que a haya pasado pues ocupa que la
(57:01) víctim sea B Pero él ocupa que él no sea la víctima no o sea leer flag y que victim sea a no Entonces sería una contradicción bueno es una contradicción es una contradicción que victim es igual a a y a b no O sea eso no puede pasar entonces se cumple exclusión mutua y simplemente es por esto no O sea sí puede ser que ambas banderas estén en true Pero la realidad es que solamente va a pasar uno el que no sea la víctima Okay como que sí está bien y ya no me dio tiempo son un Okay este entonces así nada más Les comento no peterson
(57:51) satisface starvation free Y pues lo vamos a ver la siguiente clase con las posibilidades vale Okay entonces ahí nos quedamos nos vemos el viernes Ay mañana mañana también nos vemos no en laboratorio este les subo su práctica en la mañana para que la vayan ojeando pero no se preocupen lo vemos en la clase y los ejercicios y todo va Bonito día Bye
